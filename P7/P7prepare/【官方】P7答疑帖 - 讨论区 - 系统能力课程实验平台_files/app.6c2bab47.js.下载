(function(e){function t(t){for(var r,s,o=t[0],c=t[1],u=t[2],d=0,m=[];d<o.length;d++)s=o[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&m.push(a[s][0]),a[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(m.length)m.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},a={app:0},i=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"0646":function(e,t,n){"use strict";n("4685")},3373:function(e,t,n){"use strict";n("9280")},4678:function(e,t,n){var r={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function a(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=i,e.exports=a,a.id="4678"},4685:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("router-view"),n("Message")],1)},i=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-snackbar",{attrs:{timeout:-1,color:e.messageColor,top:""},scopedSlots:e._u([{key:"action",fn:function(t){var r=t.attrs;return[e.showClose?n("v-btn",e._b({attrs:{icon:""},on:{click:e.close}},"v-btn",r,!1),[n("v-icon",[e._v("mdi-close")])],1):e._e()]}}]),model:{value:e.messageShow,callback:function(t){e.messageShow=t},expression:"messageShow"}},[e._v(" "+e._s(e.message)+" ")])},o=[],c={name:"message",data:function(){return{}},computed:{messageShow:function(){return this.$store.state.snackbar.visible},showClose:function(){return this.$store.state.snackbar.showClose},messageColor:function(){return this.$store.state.snackbar.color},timeout:function(){return this.$store.state.snackbar.timeout},message:function(){return this.$store.state.snackbar.msg}},methods:{close:function(){this.$store.commit("snackbar/CLOSE_SNACKBAR")}}},u=c,l=n("2877"),d=n("6544"),m=n.n(d),p=n("8336"),f=n("132d"),v=n("2db4"),h=Object(l["a"])(u,s,o,!1,null,null,null),g=h.exports;m()(h,{VBtn:p["a"],VIcon:f["a"],VSnackbar:v["a"]});var b={name:"App",components:{Message:g},metaInfo:{title:"",titleTemplate:"%s"+window.__app_title}},_=b,x=(n("034f"),n("7496")),w=Object(l["a"])(_,a,i,!1,null,null,null),k=w.exports;m()(w,{VApp:x["a"]});var y=n("f309");n("5363");r["a"].use(y["a"]);var I=new y["a"]({breakpoint:{mobileBreakpoint:"sm"},icons:{iconfont:"mdi"}}),j=(n("b0c0"),n("8c4f")),C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{staticClass:"indigo lighten-3",attrs:{id:"login"}},[n("v-content",[n("v-container",{attrs:{fluid:"","fill-height":""}},[n("v-layout",{attrs:{"align-center":"","justify-center":""}},[n("v-flex",{attrs:{xs12:"",sm8:"",md4:"",lg4:""}},[n("v-card",{staticClass:"elevation-1 pa-2"},[n("v-card-text",[n("div",{staticClass:"layout column align-center"},[n("h1",{staticClass:"flex my-4 primary--text text-h6"},[e._v(e._s(e.title))]),n("p",{staticClass:"primary--text text-center"},[e._v("首次登录时，请使用“忘记密码”功能重置密码")])]),n("v-form",[n("v-text-field",{attrs:{"append-icon":"mdi-account",name:"login",label:"用户",type:"text",error:e.error,rules:[e.rules.required]},model:{value:e.userEmail,callback:function(t){e.userEmail=t},expression:"userEmail"}}),n("v-text-field",{attrs:{type:e.hidePassword?"password":"text","append-icon":e.hidePassword?"mdi-eye-off":"mdi-eye",name:"password",label:"密码",id:"password",rules:[e.rules.required],error:e.error},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)},"click:append":function(t){e.hidePassword=!e.hidePassword}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),n("v-card-actions",[n("div",[n("v-btn",{attrs:{elevation:"0",text:"",color:"blue darken-4"},on:{click:e.retrievePWD}},[e._v("忘记密码")])],1),n("v-spacer"),n("v-checkbox",{attrs:{color:"blue darken-4",label:"记住会话"},model:{value:e.rememberPw,callback:function(t){e.rememberPw=t},expression:"rememberPw"}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{block:"",color:"primary",loading:e.loading},on:{click:function(t){return t.stopPropagation(),e.login(t)}}},[e._v("登录")])],1)],1)],1)],1)],1),n("v-dialog",{attrs:{"max-width":"290"},model:{value:e.courseDialog,callback:function(t){e.courseDialog=t},expression:"courseDialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v(" 选择课程 ")]),n("v-card-text",[n("v-select",{attrs:{items:e.courses,"item-text":"name","item-value":"id",label:"选择课程*",required:""},model:{value:e.courseId,callback:function(t){e.courseId=t},expression:"courseId"}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.closeDialog}},[e._v(" 取消 ")]),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.login}},[e._v(" 确定 ")])],1)],1)],1)],1)],1)},R=[],S=n("1da1"),P=(n("96cf"),n("5530")),T=n("bc3a"),V=n.n(T),O=(n("5319"),n("ac1f"),{"-2":{status:"QUEUEING"},"-1":{status:"JUDGING"},0:{status:"ACCEPTED"},1:{status:"WRONG ANSWER"},2:{status:"RUNTIME ERROR"},3:{status:"MEMORY LIMIT EXCEEDED"},4:{status:"TIME LIMIT EXCEEDED"},5:{status:"FUNCTION LIMIT VIOLATION"},6:{status:"COMPILATION ERROR"},7:{status:"PRESENTATION ERROR"},8:{status:"UNKNOWN ERROR"}}),D={0:{icon:"mdi-check-circle",color:"green",information:""},1:{icon:"mdi-close-circle",color:"red",information:""},2:{icon:"mdi-alert-circle",color:"yellow darken-3",information:"请联系助教"}},A="http://10.212.30.136:8200".replace(/\/$/,""),E=A.replace(/http/,"ws"),N="https://xqueue-bucket-1252529138.cos.ap-beijing.myqcloud.com/admin_file/profile-photo/0_admin_1621970551283_photo.png",$={0:{text:"未开始",color:"amber"},1:{text:"进行中",color:"green"},2:{text:"已结束",color:"blue-grey"},3:{text:"未激活",color:"grey"}},L={0:{text:"未签到",color:"amber"},1:{text:"已签到",color:"green"},2:{text:"已签退",color:"blue-grey"},3:{text:"排队中",color:"blue"}},B={JudgeStatus:O,JudgeResult:D,ApiUrl:A,WebSocketUrl:E,defaultPhoto:N,TimeStatusType:$,checkInStatusType:L},M=n("2f62"),F=n("bfa9"),J=n("a78e"),q=n.n(J),U={namespaced:!0,state:{msg:"",color:"",visible:!1,showClose:!0,timeout:5e3},mutations:{OPEN_SNACKBAR:function(e,t){e.visible=!0,e.msg=t.msg,e.color=t.color,e.timeout=t.timeout},CLOSE_SNACKBAR:function(e){e.visible=!1},setShowClose:function(e,t){e.showClose=t},setTimeout:function(e,t){e.timeout=t}},actions:{openSnackbar:function(e,t){var n=e.state.timeout;e.commit("OPEN_SNACKBAR",{msg:t.msg,color:t.color,timeout:null!=t.timeout?t.timeout:5e3}),n>=0&&setTimeout((function(){e.commit("CLOSE_SNACKBAR")}),n)}}},z=U,H={namespaced:!0,state:{examNotices:{}},mutations:{setNoticelist:function(e,t){r["a"].set(e.examNotices,t.pie,t.notices)},addNotice:function(e,t){e.examNotices.hasOwnProperty(t.pie)?e.examNotices[t.pie].push(t.newNotice):r["a"].set(e.examNotices,t.pie,[t.newNotice]),console.log(e.examNotices)}},getters:{getNoticesOfPie:function(e){return function(t){return e.examNotices.hasOwnProperty(t)?e.examNotices[t]:[]}}}},Y=H,G="loginInfo",W=null;try{W=JSON.parse(localStorage.getItem(G))}catch(ci){console.log("Unable to get session data: "+String(ci))}var K={namespaced:!0,state:{loginInfo:W,remember:!1,hideGraph:!1},mutations:{setInfo:function(e,t){e.loginInfo=t.info,e.remember=t.remember},setHideGraph:function(e,t){e.hideGraph=t}},actions:{login:function(e,t){var n=e.commit,r=t.info,a=t.remember;n("setInfo",{info:r,remember:a})},logout:function(e){var t=e.commit;localStorage.removeItem(G),t("setInfo",{info:null,remember:!1})}},getters:{loggedIn:function(e){return null!==e.loginInfo},userId:function(e){var t;return null===(t=e.loginInfo)||void 0===t?void 0:t.userId},name:function(e){var t;return null===(t=e.loginInfo)||void 0===t?void 0:t.name},role:function(e){var t;return null===(t=e.loginInfo)||void 0===t?void 0:t.role},token:function(e){var t;return null===(t=e.loginInfo)||void 0===t?void 0:t.token},hideGraph:function(e){return e.hideGraph}}},Q=K,X=(n("8ba4"),n("a9e3"),{namespaced:!0,state:{lastPosition:0},mutations:{updateLastPosition:function(e,t){Number.isInteger(t)&&(e.lastPosition=t)}},getters:{lastPosition:function(e){return e.lastPosition}}}),Z=X,ee={namespaced:!0,state:{timeDifference:0},mutations:{setTimeDifference:function(e,t){e.timeDifference=t}},getters:{timeDifference:function(e){return e.timeDifference}}},te=ee;r["a"].use(M["a"]);var ne=new F["a"]({restoreState:function(e,t){return q.a.getJSON(e)},saveState:function(e,t,n){t.user.remember?q.a.set(e,t,{expires:365}):q.a.set(e,t,{})},modules:["user","discussion"]}),re=new M["a"].Store({modules:{snackbar:z,notice:Y,user:Q,discussion:Z,time:te},plugins:[ne.plugin]}),ae=re;function ie(e){return se.apply(this,arguments)}function se(){return se=Object(S["a"])(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=oe(),a=r?{"X-Token":r}:{},e.prev=2,e.next=5,V()(t.url,{method:t.method,params:t.params,data:t.body,onUploadProgress:t.onUploadProgress,headers:Object(P["a"])({"Content-Type":"application/json"},a),validateStatus:function(){return!0}});case 5:n=e.sent,e.next=12;break;case 8:throw e.prev=8,e.t0=e["catch"](2),ae.dispatch("snackbar/openSnackbar",{msg:e.t0,color:"red"}),new Error(e.t0);case 12:if(200==n.status){e.next=26;break}e.t1=n.status,e.next=400===e.t1?16:401===e.t1?18:500===e.t1?22:24;break;case 16:throw ae.dispatch("snackbar/openSnackbar",{msg:n.data,color:"red"}),new Error(n.data);case 18:return ae.dispatch("user/logout"),"login"!==ni.currentRoute.name&&ni.push({name:"login",query:{redirect:ni.currentRoute.fullPath}}),ae.dispatch("snackbar/openSnackbar",{msg:"会话无效，请重新登录",color:"warning",timeout:-1}),e.abrupt("break",26);case 22:throw ae.dispatch("snackbar/openSnackbar",{msg:"500 Internal Server Error: ".concat(n.data),color:"red",timeout:-1}),new Error(n.data);case 24:throw console.log(n.data),new Error(n.data);case 26:return ae.commit("time/setTimeDifference",n.headers.date?new Date(n.headers.date).valueOf()-(new Date).valueOf():0),e.abrupt("return",n);case 28:case"end":return e.stop()}}),e,null,[[2,8]])}))),se.apply(this,arguments)}function oe(){return ae.getters["user/token"]}function ce(){return ae.getters["user/role"]}function ue(){return ae.getters["user/name"]}function le(){return ae.getters["user/userId"]}V.a.defaults.baseURL=B.ApiUrl;var de={loginurl:"/auth/login",login_status:"/auth/login-status"};function me(e){return pe.apply(this,arguments)}function pe(){return pe=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:de.loginurl,body:t,method:"post"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),pe.apply(this,arguments)}var fe={getGraph:"/course/get-graph"};function ve(e){return he.apply(this,arguments)}function he(){return he=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:fe.getGraph,params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),he.apply(this,arguments)}var ge={data:function(){return{loading:!1,userEmail:"",password:"",hidePassword:!0,error:!1,showResult:!1,result:"",rules:{required:function(e){return!!e||"Required."}},rememberPw:!1,title:window.__app_title,courses:[],courseDialog:!1,courseId:0}},metaInfo:{title:"登录 - "},methods:{closeDialog:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.courseDialog=!1;case 1:case"end":return t.stop()}}),t)})))()},login:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,n.userEmail&&n.password){t.next=6;break}n.result="用户名或密码不能为空",n.showResult=!0,t.next=21;break;case 6:return t.next=8,me({userName:n.userEmail,password:n.password,courseId:n.courseDialog?n.courseId:null});case 8:if(r=t.sent,n.closeDialog(),!r.data.courseRequired){t.next=16;break}n.courses=r.data.courses,n.courseDialog=!0,n.courseId=r.data.lastChosenCourse,t.next=21;break;case 16:return i={username:n.userEmail,userId:r.data.userId,token:r.data.token,role:r.data.role,name:r.data.name,courseName:r.data.courseName},n.$store.dispatch("user/login",{info:i,remember:n.rememberPw}),t.next=20,e.hideGraph(i.username,i.role);case 20:n.$router.push({path:null!==(a=n.$route.query.redirect)&&void 0!==a?a:"home"});case 21:case"end":return t.stop()}}),t)})))()},retrievePWD:function(){var e=this;e.$router.push({name:"retrieveP",params:{username:e.userEmail}})},hideGraph:function(e,t){var n=this;return Object(S["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(2!==t){r.next=3;break}return n.$store.commit("user/setHideGraph",!1),r.abrupt("return");case 3:return r.next=5,ve({type:"radar_chart",studentNumber:e});case 5:a=r.sent,n.$store.commit("user/setHideGraph",!a.data.found);case 7:case"end":return r.stop()}}),r)})))()}}},be=ge,_e=(n("ba95"),n("b0af")),xe=n("99d9"),we=n("ac7c"),ke=n("a523"),ye=n("a75b"),Ie=n("169a"),je=n("0e8f"),Ce=n("4bd4"),Re=n("a722"),Se=n("b974"),Pe=n("2fa4"),Te=n("8654"),Ve=Object(l["a"])(be,C,R,!1,null,"1d170540",null),Oe=Ve.exports;m()(Ve,{VApp:x["a"],VBtn:p["a"],VCard:_e["a"],VCardActions:xe["a"],VCardText:xe["c"],VCardTitle:xe["d"],VCheckbox:we["a"],VContainer:ke["a"],VContent:ye["a"],VDialog:Ie["a"],VFlex:je["a"],VForm:Ce["a"],VLayout:Re["a"],VSelect:Se["a"],VSpacer:Pe["a"],VTextField:Te["a"]});var De=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.$embeddedMode?n("v-app",[n("router-view")],1):n("v-app",{attrs:{id:"inspire"}},[n("v-navigation-drawer",{attrs:{"disable-resize-watcher":"","expand-on-hover":!e.$vuetify.breakpoint.mobile,app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[n("v-list",[e._l(e.links,(function(t){return n("v-list-item",{key:t.icon,attrs:{color:"indigo","input-value":e.selectedLink===t.name,link:""},on:{click:function(n){return e.changeLink(t.name,t.text)}}},[n("v-list-item-icon",[n("v-icon",[e._v(e._s(t.icon))])],1),n("v-list-item-content",[n("v-list-item-title",[e._v(e._s(t.text))])],1)],1)})),n("v-list-item",{attrs:{color:"indigo",link:"",href:"/tutorial/",target:"”_blank”"}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-book-open-variant")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("实验教程")])],1),n("v-list-item-icon",[n("v-icon",[e._v("mdi-open-in-new")])],1)],1)],2)],1),n("v-app-bar",{attrs:{color:"white",elevation:"1",app:""}},[e.mini?n("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}):e._e(),n("v-toolbar-title",[e._v(e._s(e.title))]),n("v-spacer"),e.tiny?e._e():n("div",[n("v-icon",[e._v("mdi-clock-outline")]),n("span",{staticStyle:{margin:"0.5em"}},[e._v(e._s(e.currentTime))])],1),n("v-menu",{attrs:{"offset-y":"","open-on-hover":"","close-on-content-click":!0},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,a=t.attrs;return[n("v-btn",e._g(e._b({attrs:{text:e.hasUnreadNotification,icon:!e.hasUnreadNotification,color:e.hasUnreadNotification?"primary":"",rounded:e.hasUnreadNotification}},"v-btn",a,!1),r),[n("v-icon",[e._v("mdi-bell-ring")]),e.hasUnreadNotification?n("span",{staticStyle:{"padding-left":"5px"}},[e._v(" "+e._s(e.unreadNotificationCount)+" ")]):e._e()],1)]}}],null,!1,467144941)},[n("v-card",[0==e.notifications.length?n("v-card-text",[n("p",{staticClass:"text--disabled"},[e._v("没有未读通知，好好学习吧~")])]):n("v-list",{staticClass:"overflow-y-auto",attrs:{"two-line":"","max-height":"400"}},[e._l(e.notifications,(function(t,r){return[n("v-list-item",{key:t.id+3,attrs:{"input-value":t.read,color:"grey"},on:{click:function(n){return e.showNotice(t)}}},[n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:e._s(t.title)}}),n("v-list-item-subtitle",{domProps:{textContent:e._s(t.createdAt.format("YYYY-MM-DD HH:mm:ss"))}})],1),n("v-list-item-action",[t.read?n("v-icon",[e._v(" mdi-email-open ")]):n("v-icon",{attrs:{color:"green"}},[e._v(" mdi-email ")])],1)],1),r<e.notifications.length-1?n("v-divider",{key:r}):e._e()]}))],2)],1)],1),n("v-btn",{attrs:{icon:""},on:{click:e.goBack}},[n("v-icon",[e._v("mdi-arrow-left-bold-circle")])],1)],1),n("v-dialog",{attrs:{width:"500",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[null!=e.curNotice?n("v-card",[n("v-card-title",[e._v(" "+e._s(e.curNotice.title)+" ")]),n("v-card-subtitle",[e._v(" "+e._s(e.curNotice.createdAt)+" ")]),n("v-divider"),n("v-card-text",[n("mavon-render",{attrs:{value:null==e.curNotice.detail?"":e.curNotice.detail.content}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"indigo",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(" 确认 ")])],1)],1):e._e()],1),n("v-dialog",{attrs:{width:"800px",scrollable:"",persistent:""},model:{value:e.pushMsgDialog,callback:function(t){e.pushMsgDialog=t},expression:"pushMsgDialog"}},[n("v-card",[n("v-card-title",[e._v("推送通知")]),n("br"),n("v-card-subtitle",[e._v(" "+e._s(e.pushMsgTitle)+" "),n("br")]),n("v-card-text",[n("div",{staticClass:"push-msg-detail"},[n("div",{domProps:{innerHTML:e._s(e.pushMsgDetailHtml)}})])]),n("v-card-actions",[n("v-btn",{attrs:{color:"indigo",text:""},on:{click:function(t){e.pushMsgDialog=!1}}},[e._v(" 关闭 ")])],1)],1)],1),n("v-main",[n("v-container",{attrs:{fluid:""}},[n("router-view",{key:e.$route.fullPath})],1)],1)],1)},Ae=[],Ee=(n("4de4"),n("d81d"),{getCourseInfo:"/course/info",getNewslist:"/news/list",getNotification:"/notifications/list",markReaded:"/notifications/markAsRead"});function Ne(){return $e.apply(this,arguments)}function $e(){return $e=Object(S["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ee.getCourseInfo,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),$e.apply(this,arguments)}function Le(e){return Be.apply(this,arguments)}function Be(){return Be=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ee.getNewslist,params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Be.apply(this,arguments)}function Me(e){return Fe.apply(this,arguments)}function Fe(){return Fe=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ee.getNotification,params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Fe.apply(this,arguments)}function Je(e){return qe.apply(this,arguments)}function qe(){return qe=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ee.markReaded,body:t,method:"post"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),qe.apply(this,arguments)}var Ue=n("c1df"),ze=n.n(Ue),He=n("d4cd"),Ye=n.n(He),Ge=Ye()(),We={data:function(){return{drawer:null,username:"",selectedLink:"",title:"",links:[{icon:"mdi-calendar-text-outline",text:"课程公告",name:"billboard"},{icon:"mdi-hexagon-slice-4",text:"课下提交",name:"underclass"},{icon:"mdi-clipboard-pulse-outline",text:"课上考试",name:"exams-list"},{icon:"mdi-comment-text-multiple",text:"讨论区",name:"discussion_area"},{icon:"mdi-account-box",text:"用户中心",name:"account"},{icon:"mdi-chart-timeline-variant-shimmer",text:"统计图",name:"graph"}],readed:0,notifications:[],dialog:!1,curNotice:null,pushMsgDialog:!1,pushMsgTitle:"",pushMsgDetailHtml:"",currentTimeValue:0,timeUpdateInterval:null}},computed:{unreadNotificationCount:function(){return this.notifications.filter((function(e){return!e.read})).length},hasUnreadNotification:function(){return 0!=this.unreadNotificationCount},loginStatus:function(){return this.$store.getters["user/loggedIn"]},mini:function(){return this.$vuetify.breakpoint.mdAndDown},tiny:function(){return this.$vuetify.breakpoint.xs},currentTime:function(){return ze()(new Date(this.currentTimeValue)).format("HH:mm:ss")}},watch:{$route:function(e){this.title=e.meta.title},loginStatus:function(e,t){!e&&t&&this.$router.push({name:"login"})},mini:function(e,t){this.drawer=!e}},mounted:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.drawer=!e.mini,e.title=e.$router.history.current.meta.title,e.selectedLink=e.$router.history.current.name,e.username=ue(),t.next=6,e.getNotices();case 6:e.initWS(),e.$store.getters["user/hideGraph"]&&(e.links=e.links.filter((function(e){return"graph"!==e.name}))),e.updateCurrentTime(),e.timeUpdateInterval=setInterval(e.updateCurrentTime,1e3);case 10:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){null!=this.socket&&(console.log("socket已关闭，不再接收通知"),this.socket.close()),null!=this.timeUpdateInterval&&clearInterval(this.timeUpdateInterval)},methods:{changeLink:function(e){this.selectedLink=e,this.$router.push({name:e})},goBack:function(){this.$router.go(-1)},getNotices:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Me({read:2});case 2:n=t.sent,e.notifications=(n.data.notifications||[]).map((function(e){return Object.assign({},e,{createdAt:ze()(e.createdAt),detail:JSON.parse(e.detail)})}));case 4:case"end":return t.stop()}}),t)})))()},showNotice:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:"discussion"==e.detail.notificationType?"posts"==t.$route.name?(t.$router.push({name:"posts",params:{dis_id:e.detail.discussionId}}),t.$router.go(0)):t.$router.push({name:"posts",params:{dis_id:e.detail.discussionId}}):"push-msg"==e.detail.notificationType&&(t.pushMsgDetailHtml=e.detail.content,t.pushMsgTitle=e.detail.title,t.pushMsgDialog=!0),setTimeout((function(){return t.$delete(t.notifications,t.notifications.indexOf(e))}),250),Je({id:e.id});case 3:case"end":return n.stop()}}),n)})))()},initWS:function(){if("undefined"===typeof WebSocket)alert("您的浏览器不支持socket");else{var e=this,t=B.WebSocketUrl+"/push?event=notifications-"+le();this.socket=new WebSocket(t),console.log("socket已打开!接收通知！"),this.socket.onerror=function(){console.log("连接错误")},this.socket.onmessage=function(t){var n=JSON.parse(t.data);if("notification"==n.type)if(n.detail=JSON.parse(n.detail),"exam-news"==n.detail.notificationType)e.curNotice=n,e.dialog=!0,e.$store.commit("notice/addNotice",{pie:n.detail.pieId,newNotice:{content:Ge.render(n.detail.content),created_at:ze()().format("YYYY-MM-DD HH:mm:ss"),star:!0,id:n.detail.newsId}});else if("discussion"==n.detail.notificationType||"course-news"==n.detail.notificationType||"push-msg"==n.detail.notificationType){var r={id:n.notificationId,title:n.title,detail:n.detail,createdAt:ze()(),read:!1};e.notifications.push(r)}}}},updateCurrentTime:function(){this.currentTimeValue=(new Date).valueOf()+this.$store.getters["time/timeDifference"]}}},Ke=We,Qe=(n("7ea5"),n("40dc")),Xe=n("5bc1"),Ze=n("ce7e"),et=n("8860"),tt=n("da13"),nt=n("1800"),rt=n("5d23"),at=n("34c3"),it=n("f6c4"),st=n("e449"),ot=n("f774"),ct=n("2a7f"),ut=Object(l["a"])(Ke,De,Ae,!1,null,null,null),lt=ut.exports;m()(ut,{VApp:x["a"],VAppBar:Qe["a"],VAppBarNavIcon:Xe["a"],VBtn:p["a"],VCard:_e["a"],VCardActions:xe["a"],VCardSubtitle:xe["b"],VCardText:xe["c"],VCardTitle:xe["d"],VContainer:ke["a"],VDialog:Ie["a"],VDivider:Ze["a"],VIcon:f["a"],VList:et["a"],VListItem:tt["a"],VListItemAction:nt["a"],VListItemContent:rt["a"],VListItemIcon:at["a"],VListItemSubtitle:rt["b"],VListItemTitle:rt["c"],VMain:it["a"],VMenu:st["a"],VNavigationDrawer:ot["a"],VSpacer:Pe["a"],VToolbarTitle:ct["a"]});var dt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-stepper",{model:{value:e.e1,callback:function(t){e.e1=t},expression:"e1"}},[n("v-stepper-header",[n("v-stepper-step",{attrs:{complete:e.e1>1,step:"1"}},[e._v(" 填写邮箱 ")]),n("v-divider"),n("v-stepper-step",{attrs:{complete:e.e1>2,step:"2"}},[e._v(" 修改密码 ")]),n("v-divider"),n("v-stepper-step",{attrs:{step:"3"}},[e._v(" 返回登录 ")])],1),n("v-stepper-items",[n("v-stepper-content",{attrs:{step:"1"}},[n("v-card",{staticClass:"mx-auto my-16",attrs:{"max-width":"600"}},[n("v-card-title",{staticClass:"flex my-4 primary--text"},[e._v(" 请输入用户名 ")]),n("v-card-text",[n("p",[e._v("如果点击“继续”时弹出结尾为 invaddr reject 错误，说明你的邮箱没有激活，请首先在 mail.buaa.edu.cn 里面激活并登录你的邮箱（可以在邮箱登录界面下方的“马上注册”按钮进行注册）")]),n("p",[e._v("如果遇到上述问题，请不要再点击“继续”按钮，先确保你的邮箱可以登录。同一个邮箱地址，如果超过 3 次出现上述错误，则在一段时间内将无法再次接收到邮件；如果遇到这种情况，请直接发邮件与我们联系。")]),n("p",[e._v("如遇到登录问题（如收不到邮件），请发邮件至 co_account@cscore.net.cn 。邮件内请表明你的身份、遇到的问题。")]),n("v-text-field",{attrs:{rules:[e.rules.required],label:"用户名"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),n("v-card-actions",[n("v-btn",{attrs:{color:"primary"},on:{click:e.check}},[e._v(" 继续 ")]),n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(t){e.email=""}}},[e._v(" 清除 ")])],1)],1),n("v-snackbar",{attrs:{timeout:2e3,top:""},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.text)+" ")])],1),n("v-stepper-content",{attrs:{step:"2"}},[n("v-card",{staticClass:"mx-auto my-16",attrs:{"max-width":"600"}},[n("v-card-title",{staticClass:"flex my-4 primary--text"},[e._v(" 邮件已发送至您的邮箱，请输入验证码和新密码 ")]),n("v-card-text",[e._v(" 验证码 "),n("v-text-field",{attrs:{rules:[e.rules.required]},model:{value:e.token,callback:function(t){e.token=t},expression:"token"}})],1),n("v-card-text",[e._v(" 新密码 "),n("v-text-field",{attrs:{rules:[e.rules.required],type:e.hidePassword?"password":"text","append-icon":e.hidePassword?"mdi-eye-off":"mdi-eye"},on:{"click:append":function(t){e.hidePassword=!e.hidePassword}},model:{value:e.newPw,callback:function(t){e.newPw=t},expression:"newPw"}})],1),n("v-card-text",[e._v(" 确认新密码 "),n("v-text-field",{attrs:{rules:[e.rules.required],type:e.hidePassword_2?"password":"text","append-icon":e.hidePassword_2?"mdi-eye-off":"mdi-eye"},on:{"click:append":function(t){e.hidePassword_2=!e.hidePassword_2}},model:{value:e.newPw_2,callback:function(t){e.newPw_2=t},expression:"newPw_2"}})],1),n("v-card-actions",[n("v-btn",{attrs:{color:"primary"},on:{click:e.submitPw}},[e._v(" 继续 ")])],1)],1),n("v-snackbar",{attrs:{timeout:2e3,top:""},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.text_Pw)+" ")])],1),n("v-stepper-content",{attrs:{step:"3"}},[n("v-card",{staticClass:"mx-auto my-16",attrs:{"max-width":"600"}},[n("v-card-title",{staticClass:"flex my-4 primary--text"},[e._v(" 密码已修改成功，请返回登录 ")]),n("v-card-actions",[n("v-btn",{attrs:{color:"primary"},on:{click:e.complete}},[e._v(" 返回登录 ")])],1)],1)],1)],1)],1)},mt=[],pt={postForgetPwdEmail:"/auth/forget-password",logout:"/auth/logout",getPhoto:"/file/get-photo",uploadPhoto:"/file/photo",resetPw:"/auth/do-reset-password"};function ft(e){return vt.apply(this,arguments)}function vt(){return vt=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:pt.postForgetPwdEmail,method:"post",body:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),vt.apply(this,arguments)}function ht(e){return gt.apply(this,arguments)}function gt(){return gt=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:pt.logout,method:"post",body:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),gt.apply(this,arguments)}function bt(e,t){return _t.apply(this,arguments)}function _t(){return _t=Object(S["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:pt.uploadPhoto,method:"post",body:t,onUploadProgress:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),_t.apply(this,arguments)}function xt(e){return wt.apply(this,arguments)}function wt(){return wt=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:pt.resetPw,method:"post",body:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),wt.apply(this,arguments)}var kt={data:function(){return{e1:1,token:"",email:"",snackbar:!1,newPw:"",newPw_2:"",hidePassword:!0,hidePassword_2:!0,text:"输入有误",text_Pw:"两次输入密码不一致",rules:{required:function(e){return!!e||"Required."}}}},metaInfo:{title:"找回密码 - "},methods:{check:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,""!==n.email){t.next=5;break}n.snackbar=!0,t.next=9;break;case 5:return t.next=7,ft({userName:n.email.replace(/\s/g,"")});case 7:r=t.sent,200===r.status&&(n.e1=2);case 9:case"end":return t.stop()}}),t)})))()},submitPw:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,n.newPw===n.newPw_2){t.next=5;break}n.snackbar=!0,t.next=9;break;case 5:return t.next=7,xt({newPassword:n.newPw.replace(/\s/g,""),token:n.token});case 7:r=t.sent,200===r.status&&(n.e1=3);case 9:case"end":return t.stop()}}),t)})))()},complete:function(){var e=this;e.$router.push({name:"login"})}},mounted:function(){this.email=this.$route.params.username}},yt=kt,It=n("7e85"),jt=n("e516"),Ct=n("9c54"),Rt=n("56a4"),St=Object(l["a"])(yt,dt,mt,!1,null,null,null),Pt=St.exports;m()(St,{VBtn:p["a"],VCard:_e["a"],VCardActions:xe["a"],VCardText:xe["c"],VCardTitle:xe["d"],VDivider:Ze["a"],VSnackbar:v["a"],VSpacer:Pe["a"],VStepper:It["a"],VStepperContent:jt["a"],VStepperHeader:Ct["a"],VStepperItems:Ct["b"],VStepperStep:Rt["a"],VTextField:Te["a"]});var Tt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"10",md:"8",lg:"6",xl:"6"}},[null!=e.userProfile?n("v-card",[e._t("progress",[e.uploading?n("v-progress-linear",{attrs:{value:e.uploadedBytes/e.totalBytes*100}}):e._e()]),n("v-card-title",[e._v("管理您的账号")]),n("v-divider"),n("v-list",{attrs:{"two-line":""}},[n("v-row",[n("v-col",[n("v-list-item",[n("v-list-item-icon",[n("v-icon",{attrs:{color:"indigo"}},[e._v("mdi-card-account-details")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("姓名")]),n("v-list-item-subtitle",[e._v(" "+e._s(e.userProfile.name)+" ")])],1)],1),n("v-list-item",[n("v-list-item-icon"),n("v-list-item-content",[n("v-list-item-title",[e._v("用户名")]),n("v-list-item-subtitle",[e._v(" "+e._s(e.userProfile.userName)+" ")])],1)],1),n("v-list-item",[n("v-list-item-icon"),n("v-list-item-content",[n("v-list-item-title",[e._v("身份")]),n("v-list-item-subtitle",[e._v(" "+e._s(e.userProfile.roleName)+" ")])],1)],1)],1),n("v-col",{staticStyle:{padding:"2em"},attrs:{align:"center",justify:"center"}},[n("v-avatar",{attrs:{size:"128"}},[n("img",{attrs:{src:e.userProfile.profilePhoto}})]),n("v-file-input",{staticStyle:{"font-size":"0.875rem"},attrs:{"prepend-icon":"mdi-camera",placeholder:"选择新头像",accept:"image/*"},on:{change:e.upload_photo},model:{value:e.newAvatar,callback:function(t){e.newAvatar=t},expression:"newAvatar"}})],1)],1),n("v-divider",{attrs:{inset:""}}),n("v-list-item",[n("v-list-item-icon",[n("v-icon",{attrs:{color:"indigo"}},[e._v("mdi-email")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("电子邮件地址")]),n("v-list-item-subtitle",[e._v(" "+e._s(e.userProfile.email)+" ")])],1),n("v-list-item-action",[n("v-btn",{attrs:{text:"",color:"primary",loading:e.testEmailSending,disabled:e.testEmailSent},on:{click:e.testEmail}},[e._v(e._s(e.testEmailSent?"已发送":"测试"))])],1)],1)],1),n("v-divider"),n("v-card-actions",{staticStyle:{margin:"0px 5px 5px 5px"}},[n("v-spacer"),n("v-dialog",{attrs:{width:"500",persistent:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,a=t.attrs;return[n("v-btn",e._g(e._b({attrs:{text:"",color:"deep-orange darken-2"}},"v-btn",a,!1),r),[e._v("修改电子邮件地址")])]}}],null,!1,1252241300),model:{value:e.editEmailDialog,callback:function(t){e.editEmailDialog=t},expression:"editEmailDialog"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5"},[e._v("修改电子邮件地址")]),n("v-card-text",[n("v-text-field",{ref:"pwdInput",attrs:{label:"当前密码",rules:e.pwdRules,clearable:"",disabled:e.newEmailSending,type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("v-text-field",{ref:"emailInput",attrs:{label:"新 E-mail 地址",rules:e.emailRules,clearable:"",disabled:e.newEmailSending},on:{change:e.changeEmailText},scopedSlots:e._u([{key:"append-outer",fn:function(){return[n("v-btn",{attrs:{color:"primary",text:"",loading:e.newEmailSending},on:{click:e.sendNewEmailVerification}},[e._v("验证")])]},proxy:!0}],null,!1,3895933348),model:{value:e.newEmail,callback:function(t){e.newEmail=t},expression:"newEmail"}}),e.newEmailSent?n("v-text-field",{attrs:{label:"验证码",clearable:""},scopedSlots:e._u([{key:"append-outer",fn:function(){return[n("v-btn",{attrs:{color:"primary",text:"",loading:e.newEmailTokenConfirming},on:{click:e.confirmNewEmail}},[e._v("确认")])]},proxy:!0}],null,!1,1820078209),model:{value:e.newEmailToken,callback:function(t){e.newEmailToken=t},expression:"newEmailToken"}}):e._e()],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"deep-orange darken-2",text:""},on:{click:function(t){e.editEmailDialog=!1}}},[e._v("取消")])],1)],1)],1),n("v-btn",{attrs:{text:"",color:"deep-orange darken-2"},on:{click:e.resetPW}},[e._v("重置密码")]),n("v-btn",{attrs:{text:"",color:"deep-orange darken-2"},on:{click:e.log_out}},[e._v("退出登录")])],1)],2):n("v-skeleton-loader",{attrs:{type:"card-avatar, article, actions"}})],1)],1)},Vt=[],Ot=(n("498a"),{getUserProfile:"/userprofile/get",sendTestEmail:"/userprofile/send-test-email",sendResetEmailRequest:"/userprofile/send-reset-email-request",doResetEmail:"/userprofile/do-reset-email"});function Dt(){return At.apply(this,arguments)}function At(){return At=Object(S["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ot.getUserProfile,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),At.apply(this,arguments)}function Et(){return Nt.apply(this,arguments)}function Nt(){return Nt=Object(S["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ot.sendTestEmail,method:"post"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Nt.apply(this,arguments)}function $t(e){return Lt.apply(this,arguments)}function Lt(){return Lt=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ot.sendResetEmailRequest,body:t,method:"post"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Lt.apply(this,arguments)}function Bt(e){return Mt.apply(this,arguments)}function Mt(){return Mt=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ot.doResetEmail,body:t,method:"post"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Mt.apply(this,arguments)}var Ft={data:function(){return{userProfile:null,testEmailSending:!1,testEmailSent:!1,editEmailDialog:!1,password:"",newEmail:"",newEmailSending:!1,newEmailSent:!1,newEmailToken:"",newEmailTokenConfirming:!1,newAvatar:null,emailRules:[function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||"地址无效"}],pwdRules:[function(e){return e.length>0||"请输入账号的密码"}],uploading:!1,totalBytes:0,uploadedBytes:0}},metaInfo:{title:"用户中心 - "},watch:{editEmailDialog:function(e,t){e!=t&&(this.newEmailSent=!1,this.newEmail="",this.password="",this.newEmailToken="")}},methods:{resetPW:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ht({});case 2:e.$store.dispatch("user/logout"),e.$router.push({name:"retrieveP",params:{username:e.userProfile.userName}});case 4:case"end":return t.stop()}}),t)})))()},log_out:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ht({});case 2:e.$store.dispatch("user/logout"),e.$router.push({name:"login",query:{redirect:"/home"}});case 4:case"end":return t.stop()}}),t)})))()},upload_photo:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!==e.newAvatar){t.next=2;break}return t.abrupt("return");case 2:return n=new FormData,n.append("file",e.newAvatar),e.uploading=!0,t.next=7,bt(n,(function(t){e.totalBytes=t.total,e.uploadedBytes=t.loaded}));case 7:r=t.sent,e.uploading=!1,e.newAvatar=null,e.userProfile.profilePhoto=r.data.url;case 11:case"end":return t.stop()}}),t)})))()},testEmail:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.testEmailSending=!0,t.next=3,Et();case 3:e.testEmailSending=!1,e.testEmailSent=!0,e.$store.dispatch("snackbar/openSnackbar",{msg:"成功发送测试邮件，请查收",color:"green"});case 6:case"end":return t.stop()}}),t)})))()},changeEmailText:function(){this.newEmailSent=!1},sendNewEmailVerification:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.pwdInput.validate()||!e.$refs.emailInput.validate()){t.next=13;break}return e.newEmailSending=!0,t.prev=2,t.next=5,$t({password:e.password,newEmail:e.newEmail});case 5:t.next=11;break;case 7:return t.prev=7,t.t0=t["catch"](2),e.newEmailSending=!1,t.abrupt("return");case 11:e.newEmailSending=!1,e.newEmailSent=!0;case 13:case"end":return t.stop()}}),t,null,[[2,7]])})))()},confirmNewEmail:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.newEmailTokenConfirming=!0,t.prev=1,t.next=4,Bt({token:e.newEmailToken.trim()});case 4:t.next=10;break;case 6:return t.prev=6,t.t0=t["catch"](1),e.newEmailTokenConfirming=!1,t.abrupt("return");case 10:e.newEmailTokenConfirming=!1,e.userProfile.email=e.newEmail,e.editEmailDialog=!1;case 13:case"end":return t.stop()}}),t,null,[[1,6]])})))()}},mounted:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Dt();case 2:e.userProfile=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()}},Jt=Ft,qt=n("8212"),Ut=n("62ad"),zt=n("23a7"),Ht=n("8e36"),Yt=n("0fd9"),Gt=n("3129"),Wt=Object(l["a"])(Jt,Tt,Vt,!1,null,null,null),Kt=Wt.exports;m()(Wt,{VAvatar:qt["a"],VBtn:p["a"],VCard:_e["a"],VCardActions:xe["a"],VCardText:xe["c"],VCardTitle:xe["d"],VCol:Ut["a"],VDialog:Ie["a"],VDivider:Ze["a"],VFileInput:zt["a"],VIcon:f["a"],VList:et["a"],VListItem:tt["a"],VListItemAction:nt["a"],VListItemContent:rt["a"],VListItemIcon:at["a"],VListItemSubtitle:rt["b"],VListItemTitle:rt["c"],VProgressLinear:Ht["a"],VRow:Yt["a"],VSkeletonLoader:Gt["a"],VSpacer:Pe["a"],VTextField:Te["a"]});var Qt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-toolbar",{attrs:{color:"indigo lighten-4",elevation:"1",dark:""}},[n("v-toolbar-title",[e._v("讨论区 ")]),n("v-spacer"),n("v-text-field",{ref:"search_input",staticStyle:{"max-width":"400px"},attrs:{flat:"","hide-details":"",label:"Search","prepend-inner-icon":"mdi-magnify","solo-inverted":""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchTopic(t)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-chip-group",{attrs:{multiple:"",column:""},on:{change:e.tag_search},model:{value:e.tags_search_id,callback:function(t){e.tags_search_id=t},expression:"tags_search_id"}},[e._l(e.all_tags,(function(t){return n("v-chip",{key:t.tagName,attrs:{filter:!0,outlined:"",color:"indigo lighten-2"}},[e._v(" "+e._s(t.tagName)+" ")])})),e.all_tags.length>0?n("v-btn",{attrs:{icon:""},on:{click:e.clear_tag_search}},[n("v-icon",[e._v("mdi-autorenew")])],1):e._e()],2)],1)],1),n("div",{staticStyle:{"margin-top":"2em"}},[n("v-row",{staticClass:"posts"},e._l(e.limit,(function(t){return n("v-col",{key:t,staticStyle:{"align-self":"stretch !important"},attrs:{cols:"12",sm:"12",md:"6",lg:"4","align-self":"center",id:"post-"+(t-1)}},[n("div",{staticClass:"card_flex"},[void 0===e.list[t-1]?n("v-skeleton-loader",{attrs:{type:"card-heading, text@3, actions",elevation:"1"}}):n("v-card",{key:t,staticClass:"card d-flex flex-column",staticStyle:{height:"100%"},attrs:{elevation:"1",outlined:""}},[n("div",[e.isadmin?e._e():n("v-chip",{staticClass:"ma-2",attrs:{color:e.color[e.list[t-1].Priority],label:"",small:"","text-color":"white"}},[e._v(" "+e._s(e.statusToText(e.list[t-1].Priority))+" ")]),!e.list[t-1].showPriority&&e.isadmin?n("v-chip",{staticClass:"ma-2",attrs:{color:e.color[e.list[t-1].Priority],label:"","text-color":"white",small:""},on:{click:function(n){return e.showPriority(t-1)}}},[e._v(" "+e._s(e.statusToText(e.list[t-1].Priority))+" "),n("v-icon",{attrs:{right:"",small:""}},[e._v("mdi-pencil")])],1):e._e(),e.list[t-1].showPriority?n("v-chip-group",{attrs:{column:""}},e._l(4,(function(r){return n("v-chip",{key:r,staticClass:"ma-2",attrs:{color:e.color[4-r],label:"",small:"","text-color":"white"},on:{click:function(n){return e.changePriority(e.list[t-1].Id,4-r)}}},[e._v(" "+e._s(e.statusToText(4-r))+" ")])})),1):e._e(),e.list[t-1].Closed?n("v-chip",{staticClass:"ma-2",attrs:{label:"",small:"",color:"deep-purple darken-3","text-color":"white"}},[e._v(" 已关闭 ")]):e.list[t-1].Follow_num>0||e.list[t-1].Response_num>0?n("v-chip",{staticClass:"ma-2",attrs:{label:"",small:"",color:e.postHeatColors[Math.min(Math.floor((e.list[t-1].Follow_num+e.list[t-1].Response_num)/e.postHeatLevelMargin),e.postHeatColors.length-1)].background,"text-color":e.postHeatColors[Math.min(Math.floor((e.list[t-1].Follow_num+e.list[t-1].Response_num)/e.postHeatLevelMargin),e.postHeatColors.length-1)].font}},[e._v(" "+e._s(e.list[t-1].Follow_num)+" 关注 | "+e._s(e.list[t-1].Response_num)+" 回复 ")]):e._e()],1),n("v-card-text",[n("div",{staticClass:"overflow-dots"},[n("router-link",{staticClass:"text-h6 black--text",attrs:{to:{name:"posts",params:{dis_id:e.list[t-1].Id,Author_id:e.list[t-1].Author_id}}}},[e._v(" "+e._s(e.list[t-1].Title)+" ")])],1)]),n("v-card-text",[n("div",{staticClass:"overflow-dots-block"},[e._v(" "+e._s(e.list[t-1].preview)+" ")])]),n("v-card-text",[n("v-chip-group",{attrs:{column:""}},e._l(e.tags_list4dis[t-1],(function(t){return n("v-chip",{key:t.tagName,staticStyle:{"pointer-events":"none"},attrs:{small:"",color:"indigo lighten-4"}},[e._v(" "+e._s(t.tagName)+" ")])})),1)],1),n("v-spacer"),n("v-card-actions",[n("v-row",{attrs:{align:"center"}},[n("span",{staticStyle:{"font-size":"10px",color:"grey",margin:"1px 20px 1px 20px"}},[e._v(" "+e._s(e.list[t-1].First_name)+"("+e._s(e.list[t-1].Last_name)+")发布于"+e._s(e.list[t-1].new_datatime)+" ")]),n("v-spacer"),n("v-btn",{staticClass:"common-icon",attrs:{dark:"",elevation:"0",icon:"",color:e.list[t-1].Followed?"red":"grey lighten-1"},on:{click:function(n){return e.care(e.list[t-1].id,e.list[t-1].Id)}}},[n("v-icon",[e._v("mdi-heart")])],1),e.isadmin?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(r){var a=r.on,i=r.attrs;return[n("v-btn",e._g(e._b({staticClass:"common-icon",attrs:{dark:"",small:"",icon:"",elevation:"0",color:e.list[t-1].Closed?e.color_close[0]:e.color_close[1]},on:{click:function(n){return e.permit_response(e.list[t-1].Id)}}},"v-btn",i,!1),a),[n("v-icon",[e._v("mdi-power")])],1)]}}],null,!0)},[n("span",[e._v(e._s(e.closeTipText(e.list[t-1].Closed)))])]):e._e(),e.isadmin?n("v-btn",{staticClass:"common-icon",attrs:{dark:"",small:"",icon:"",elevation:"0",color:"black"},on:{click:function(n){e.delete_target=e.list[t-1].Id,e.delete_confirmation=!0}}},[n("v-icon",[e._v("mdi-delete")])],1):e._e(),n("div")],1)],1)],1)],1)])})),1)],1),n("div",{ref:"limit_bar",staticStyle:{margin:"1em auto",width:"min-content"}},[n("v-btn",{attrs:{text:"",block:""},on:{click:function(t){e.$refs.back_top.click(),e.$refs.search_input.focus()}}},[e._v(" "+e._s("错过了些什么？ "+(e.is_search?"换个关键词":"试试搜索功能")+" >>")+" ")]),n("v-btn",{attrs:{text:"",block:""},on:{click:function(t){e.dialog=!0}}},[e._v(" 找不到想讨论的问题？ 自己创建一个 >> ")])],1)],1),n("div",{staticClass:"speed-dial"},[n("v-fab-transition",[n("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.showBackTop,expression:"showBackTop"}],ref:"back_top",attrs:{fab:"",dark:"",large:"",color:"blue darken-2"},on:{click:function(t){return e.back_top()}}},[n("v-icon",[e._v("mdi-arrow-up")])],1)],1),n("v-btn",{attrs:{color:"indigo",fab:"",dark:"",large:""},on:{click:function(t){e.dialog=!0}}},[n("v-icon",[e._v("mdi-plus")])],1)],1),n("v-dialog",{staticStyle:{"z-index":"1501"},attrs:{persistent:"","max-width":"1000px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-subtitle",[n("v-container",[n("p",{staticClass:"headline",staticStyle:{"margin-top":"30px"}},[e._v("请输入帖子标题")]),n("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,a=t.attrs;return[n("v-text-field",e._g(e._b({model:{value:e.Title,callback:function(t){e.Title="string"===typeof t?t.trim():t},expression:"Title"}},"v-text-field",a,!1),r))]}}])},[n("v-list",e._l(e.smart_list,(function(t){return n("v-list-item",{key:t.Title,attrs:{link:""}},[n("v-list-item-content",{on:{click:function(n){return e.smartRecommend(t)}}},[e._v(" "+e._s(t.Title)+" ")])],1)})),1)],1)],1)],1),n("v-card-subtitle",[n("v-container",[n("p",{staticClass:"headline"},[e._v("请输入问题描述")])])],1),n("v-card-text",[n("v-container",[n("mavon-editor",{ref:"post_md",staticStyle:{width:"100%","z-index":"1 !important"},attrs:{ishljs:!0},on:{imgAdd:e.$imgAdd},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1),n("v-card-actions",[n("v-btn",{attrs:{color:"indigo lighten-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(" 关闭 ")]),n("v-spacer"),n("v-btn",{attrs:{color:"indigo lighten-1",text:"",disabled:e.disableSubmitDiscussion},on:{click:function(t){return e.add_discussion(!1)}}},[e._v(" 提交 ")])],1)],1)],1),n("v-dialog",{attrs:{"max-width":"288"},model:{value:e.delete_confirmation,callback:function(t){e.delete_confirmation=t},expression:"delete_confirmation"}},[n("v-card",[n("v-card-title",[e._v("确定要删除此讨论帖吗？")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.delete_confirmation=!1}}},[e._v(" 取消 ")]),n("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(t){e.delete_confirmation=!1,e.delete_discussion(e.delete_target)}}},[e._v(" 确定 ")])],1)],1)],1)],1)},Xt=[],Zt=n("2909"),en=(n("caad"),n("2532"),n("a434"),n("841c"),n("159b"),n("99af"),{discussion_add:"/discussion/discussion-add",discussion_delete:"/discussion_admin/discussion-delete",discussion_list:"/discussion/discussion-list",discussion_priority:"/discussion_admin/discussion-priority",discussion_follow:"/discussion/discussion-follow",response_permission:"/discussion_admin/discussion-permission",uploadImg:"/file/upload",discussion_search:"/discussion/discussion-search",discussion_tag_details:"discussion/get-tag-details",discussion_add_tag:"/discussion/add-tag",discussion_delete_tag:"/discussion/delete-tag",discussion_search_by_tags:"/discussion/discussion-search-by-tags"});function tn(e){return nn.apply(this,arguments)}function nn(){return nn=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:en.discussion_tag_details,method:"get",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),nn.apply(this,arguments)}function rn(e){return an.apply(this,arguments)}function an(){return an=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:en.discussion_add_tag,method:"post",body:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),an.apply(this,arguments)}function sn(e){return on.apply(this,arguments)}function on(){return on=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:en.discussion_delete_tag,method:"post",body:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),on.apply(this,arguments)}function cn(e){return un.apply(this,arguments)}function un(){return un=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:en.discussion_search_by_tags,method:"post",body:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),un.apply(this,arguments)}function ln(e){return dn.apply(this,arguments)}function dn(){return dn=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:en.discussion_add,method:"post",body:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),dn.apply(this,arguments)}function mn(e){return pn.apply(this,arguments)}function pn(){return pn=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:en.discussion_delete,method:"post",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),pn.apply(this,arguments)}function fn(e){return vn.apply(this,arguments)}function vn(){return vn=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:en.discussion_list,method:"get",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),vn.apply(this,arguments)}function hn(e){return gn.apply(this,arguments)}function gn(){return gn=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:en.discussion_priority,method:"post",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),gn.apply(this,arguments)}function bn(e){return _n.apply(this,arguments)}function _n(){return _n=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:en.discussion_follow,method:"post",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),_n.apply(this,arguments)}function xn(e){return wn.apply(this,arguments)}function wn(){return wn=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:en.response_permission,method:"post",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),wn.apply(this,arguments)}function kn(e){return yn.apply(this,arguments)}function yn(){return yn=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:en.uploadImg,body:t,method:"post"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),yn.apply(this,arguments)}function In(e){return jn.apply(this,arguments)}function jn(){return jn=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:en.discussion_search,method:"get",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),jn.apply(this,arguments)}var Cn={response_add:"/discussion/response-add",response_delete:"/discussion_admin/response-delete",response_list:"/discussion/response-list",response_authority:"/discussion_admin/response-authority",response_vote:"/discussion/response-vote",response_cite:"/discussion/response-cite",discussion_info:"/discussion/discussion-info",response_modify:"/discussion/response-modify"};function Rn(e){return Sn.apply(this,arguments)}function Sn(){return Sn=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Cn.response_add,method:"post",body:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Sn.apply(this,arguments)}function Pn(e){return Tn.apply(this,arguments)}function Tn(){return Tn=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Cn.response_delete,method:"post",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Tn.apply(this,arguments)}function Vn(e){return On.apply(this,arguments)}function On(){return On=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Cn.response_list,method:"get",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),On.apply(this,arguments)}function Dn(e){return An.apply(this,arguments)}function An(){return An=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Cn.response_authority,method:"post",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),An.apply(this,arguments)}function En(e){return Nn.apply(this,arguments)}function Nn(){return Nn=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Cn.response_vote,method:"post",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Nn.apply(this,arguments)}function $n(e){return Ln.apply(this,arguments)}function Ln(){return Ln=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Cn.discussion_info,method:"post",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Ln.apply(this,arguments)}function Bn(e){return Mn.apply(this,arguments)}function Mn(){return Mn=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Cn.response_modify,method:"post",body:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Mn.apply(this,arguments)}var Fn={data:function(){return{isadmin:!1,direction:"left",Title:"",value:"",dialog:!1,smart_list:[{Title:"相关的帖子会显示在这，发布前可以看看有无重复",flag:1}],color:["grey","green","blue darken-1","red"],list:[],status:"",typelist:[{id:1,title:"ALL"},{id:2,title:"P1"},{id:3,title:"P2"},{id:4,title:"P3"},{id:5,title:"P4"},{id:6,title:"P5"},{id:7,title:"P6"},{id:8,title:"P7"},{id:9,title:"P8"}],topic:["P1","P2","P3","P4","P5","P6","P7","P8"],topic_id:"",topicmap:{P1:2,P2:3,P3:4,P4:5,P5:6,P6:7,P7:8,P8:9},pagenum:0,pagesize:12,color_close:["red","green"],search:"",delete_confirmation:!1,delete_target:-1,total_post:0,limit:0,limit_el:null,limit_observer:null,init_load:!0,is_search:!1,course_id:1,visible_list:[],visible_observer:null,postHeatColors:[{background:"grey lighten-2",font:"grey darken-3"},{background:"lime lighten-2",font:"grey darken-3"},{background:"orange lighten-2",font:"grey darken-3"},{background:"pink darken-1",font:"grey lighten-5"}],postHeatLevelMargin:15,tags_list4dis:[],all_tags:[],tags_search_id:[]}},watch:{Title:{handler:function(){this.fetchData()}},visible_list:{handler:function(){this.$store.commit("discussion/updateLastPosition",Math.min.apply(Math,Object(Zt["a"])(this.visible_list)))}},list:{handler:function(){this.addTags4dis()}}},computed:{showBackTop:function(){return this.total_post>0&&!this.visible_list.includes(0)},disableSubmitDiscussion:function(){return 0===this.Title.length||0===this.value.trim().length}},metaInfo:{title:"讨论区 - "},methods:{getDiscussionTags:function(e){return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,tn({DiscussionId:e});case 2:return n=t.sent,t.abrupt("return",n.data.tagDataArray);case 4:case"end":return t.stop()}}),t)})))()},addTags4dis:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<e.list.length)){t.next=11;break}return r=e.list[n].Id,t.next=5,e.getDiscussionTags(r);case 5:a=t.sent,0===e.all_tags.length&&e.setAllTags(a),e.tags_list4dis[n]=a.filter((function(e){return!0===e.owned}));case 8:n++,t.next=1;break;case 11:e.$forceUpdate();case 12:case"end":return t.stop()}}),t)})))()},setAllTags:function(e){this.all_tags=e},tag_search:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.tags_search_id.length;a++)r.push(e.all_tags[e.tags_search_id[a]].tagName);if(0!==r.length){t.next=7;break}return e.is_search=!1,t.next=6,e.reload_discussion_list(e.course_id);case 6:return t.abrupt("return");case 7:return e.is_search=!0,e.limit_observer.disconnect(),e.visible_observer.disconnect(),t.next=12,cn({tags:r});case 12:i=t.sent,e.list=e.processData(null!==(n=i.data)&&void 0!==n?n:[]),e.limit=e.list.length;case 15:case"end":return t.stop()}}),t)})))()},clear_tag_search:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tags_search_id.splice(0,e.tags_search_id.length),e.tags_list4dis.splice(0,e.tags_list4dis.length),t.next=4,e.tag_search();case 4:case"end":return t.stop()}}),t)})))()},fetchData:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,""!==n.Title){t.next=5;break}return n.smart_list=[],n.smart_list.push({Title:"相关的帖子会显示在这，发布前可以看看有无重复",flag:1}),t.abrupt("return");case 5:return t.next=7,In({keywords:n.Title});case 7:r=t.sent,n.smart_list=r.data,null==n.smart_list&&(n.smart_list=[],n.smart_list.push({Title:"很抱歉没有找到相关帖子",flag:1})),e.$forceUpdate();case 11:case"end":return t.stop()}}),t)})))()},searchTopic:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e,""!==r.search){t.next=6;break}return r.is_search=!1,t.next=5,r.reload_discussion_list(r.course_id);case 5:return t.abrupt("return");case 6:return r.is_search=!0,r.limit_observer.disconnect(),r.visible_observer.disconnect(),t.next=11,In({keywords:r.search});case 11:a=t.sent,r.list=r.processData(null!==(n=a.data)&&void 0!==n?n:[]),r.limit=r.list.length;case 14:case"end":return t.stop()}}),t)})))()},smartRecommend:function(e){1!==e.flag&&("posts"===this.$route.name?(this.$router.push({name:"posts",params:{dis_id:e.Id,Author_id:e.Author_id}}),this.$router.go(0)):this.$router.push({name:"posts",params:{dis_id:e.Id,Author_id:e.Author_id}}))},showPriority:function(e){console.log("show priority",e),this.isadmin&&(console.log("isadmin"),this.list[e].showPriority=!0,this.$forceUpdate())},changePriority:function(e,t){var n=this;return Object(S["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,hn({discussionId:e,priority:t});case 2:return r.sent,r.next=5,n.reload_discussion_list(1);case 5:case"end":return r.stop()}}),r)})))()},permit_response:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,xn({discussionId:e});case 2:return n.sent,n.next=5,t.reload_discussion_list(1);case 5:case"end":return n.stop()}}),n)})))()},care:function(e,t){var n=this;return Object(S["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,bn({discussionId:t});case 2:return e.sent,e.next=5,n.reload_discussion_list(1);case 5:case"end":return e.stop()}}),e)})))()},delete_discussion:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,mn({discussionId:e});case 2:return n.sent,n.next=5,t.reload_discussion_list(1);case 5:case"end":return n.stop()}}),n)})))()},add_discussion:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,""!==n.value){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,ln({problemId:1,title:n.Title,content:n.value});case 5:return t.sent,n.dialog=!1,t.next=9,n.reload_discussion_list(1);case 9:n.value="",n.Title="",n.topic_id="";case 12:case"end":return t.stop()}}),t)})))()},load_posts:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){var r,a,i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=t,i=a.limit,i+e>a.total_post&&(e=a.total_post-i),(a.limit+=e)===a.total_post&&a.limit_observer.disconnect(),n.next=6,fn({courseId:a.course_id,problemId:1,queryOffset:i,queryQuantity:e});case 6:s=n.sent,a.processData(null!==(r=s.data.Discussion_list)&&void 0!==r?r:[]).forEach((function(e,t){a.$set(a.list,i+t,e),a.visible_observer.observe(document.getElementById("post-".concat(i+t)))}));case 8:case"end":return n.stop()}}),n)})))()},lazy_load_handler:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e[0],r.isIntersecting){n.next=3;break}return n.abrupt("return");case 3:a=t,a.load_posts(a.pagesize);case 5:case"end":return n.stop()}}),n)})))()},get_total_posts:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t,n.next=3,fn({courseId:e,problemId:1,queryOffset:0,queryQuantity:0});case 3:return a=n.sent,r.total_post=a.data.MaxCount,n.abrupt("return",200===a.status);case 6:case"end":return n.stop()}}),n)})))()},$imgAdd:function(e,t){var n=this;return Object(S["a"])(regeneratorRuntime.mark((function r(){var a,i,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=new FormData,a.append("file",t),r.next=4,kn(a);case 4:i=r.sent,s=i.data.url,n.$refs.post_md.$img2Url(e,s);case 7:case"end":return r.stop()}}),r)})))()},statusToText:function(e){return["无意义","普通","加精","置顶"][e]},closeTipText:function(e){return e?"开启此帖":"关闭此帖"},processData:function(e){var t=this;return e.map((function(e,n){return Object(P["a"])(Object(P["a"])({},e),{},{content:e.Content,id:n,btn:!1,showPriority:!1,preview:t.$mavonPreview(e.Content),new_datatime:e.Created_at.substr(0,e.Created_at.indexOf("T"))})}))},reload_discussion_list:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){var r,a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t,n.next=3,r.get_total_posts(e);case 3:if(a=n.sent,r.limit=0,r.list=[],a){n.next=8;break}return n.abrupt("return");case 8:return i=r.$store.getters["discussion/lastPosition"],n.next=11,r.load_posts(Math.ceil((i+1)/r.pagesize)*r.pagesize);case 11:if(r.$vuetify.goTo("#post-".concat(i)),r.limit!=r.total_post){n.next=14;break}return n.abrupt("return");case 14:r.limit_observer.observe(r.$refs.limit_bar);case 15:case"end":return n.stop()}}),n)})))()},visible_handler:function(e){var t=this,n=e.filter((function(e){return e.isIntersecting})).map((function(e){return parseInt(e.target.id.substr(5))})),r=e.filter((function(e){return!e.isIntersecting})).map((function(e){return parseInt(e.target.id.substr(5))}));t.visible_list=t.visible_list.filter((function(e){return!r.includes(e)})).concat(n)},back_top:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e,n.visible_observer.disconnect(),t.next=4,n.$vuetify.goTo(0);case 4:for(r=0;r<n.limit;++r)n.visible_observer.observe(document.getElementById("post-".concat(r)));case 5:case"end":return t.stop()}}),t)})))()}},created:function(){this.limit_observer=new IntersectionObserver(this.lazy_load_handler,{threshold:.1}),this.visible_observer=new IntersectionObserver(this.visible_handler,{threshold:.5}),2===ce()&&(this.isadmin=!0)},mounted:function(){this.reload_discussion_list(this.course_id)}},Jn=Fn,qn=(n("0646"),n("cc20")),Un=n("ef9a"),zn=n("0789"),Hn=n("71d9"),Yn=n("3a2f"),Gn=Object(l["a"])(Jn,Qt,Xt,!1,null,"69520b6e",null),Wn=Gn.exports;m()(Gn,{VBtn:p["a"],VCard:_e["a"],VCardActions:xe["a"],VCardSubtitle:xe["b"],VCardText:xe["c"],VCardTitle:xe["d"],VChip:qn["a"],VChipGroup:Un["a"],VCol:Ut["a"],VContainer:ke["a"],VDialog:Ie["a"],VFabTransition:zn["c"],VIcon:f["a"],VList:et["a"],VListItem:tt["a"],VListItemContent:rt["a"],VMenu:st["a"],VRow:Yt["a"],VSkeletonLoader:Gt["a"],VSpacer:Pe["a"],VTextField:Te["a"],VToolbar:Hn["a"],VToolbarTitle:ct["a"],VTooltip:Yn["a"]});var Kn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{margin:"0 0 0 0"}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"10",md:"10",lg:"10"}},[n("v-card",{attrs:{elevation:"0"}},[n("v-card-title",[n("span",{staticStyle:{"font-size":"24px"}},[e._v(e._s(e.text))])])],1)],1)],1),n("v-row",[n("v-col",{attrs:{cols:"10",offset:"1"}},[n("v-chip-group",{attrs:{column:""}},[e._l(e.tags_added,(function(t){return n("v-chip",{key:t.tagName,style:{"pointer-events":e.editing_tags?"auto":"none"},attrs:{close:e.editing_tags,color:"indigo lighten-4"},on:{"click:close":function(n){return e.delete_tag(t.tagName)}}},[e._v(" "+e._s(t.tagName)+" ")])})),e.editing_tags||e.Author_id!==e.userId&&!e.isadmin?e._e():n("v-btn",{attrs:{icon:""},on:{click:function(t){e.editing_tags=!0}}},[n("v-icon",[e._v("mdi-tag-plus-outline")])],1)],2),e.editing_tags&&(e.Author_id===e.userId||e.isadmin)?n("v-chip-group",{attrs:{column:""}},[e._l(e.tags_unplaced,(function(t){return n("v-chip",{key:t.tagName,attrs:{outlined:""},on:{click:function(n){return e.add_tag(t.tagName)}}},[e._v(" "+e._s(t.tagName)+" ")])})),n("v-btn",{attrs:{icon:""},on:{click:function(t){e.editing_tags=!1}}},[n("v-icon",[e._v("mdi-checkbox-marked-circle-outline")])],1)],2):e._e()],1)],1),n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"10",md:"10",lg:"10"}},[n("v-list",{attrs:{dense:""}},e._l(e.root_list,(function(t){return n("v-list-item",{key:t.Id},[t.Citing_root===t.Id?n("v-list-item-content",[n("v-card",{staticClass:"card",attrs:{elevation:"1",outlined:""}},[n("v-card-title",[n("v-row",[n("div",{class:{"avatar-adapt":"xs"!==e.$vuetify.breakpoint.name}},[n("v-avatar",{staticStyle:{margin:"6px 3px 3px 3px"},attrs:{size:"xs"===e.$vuetify.breakpoint.name?20:40}},[n("v-img",{attrs:{src:t.Photo_url}})],1)],1),n("span",{class:{name:"xs"!==e.$vuetify.breakpoint.name,"name-mobile":"xs"===e.$vuetify.breakpoint.name}},[e._v(e._s(t.First_name)+" "+e._s(e.showStudentId(t.User_student_id,t.Last_name))+" ("+e._s(t.Last_name)+")")]),n("v-spacer"),!e.isadmin&&t.Authority?n("v-chip",{class:{"common-chip":"xs"!==e.$vuetify.breakpoint.name,"common-chip-mobile":"xs"===e.$vuetify.breakpoint.name},attrs:{color:"green",small:"xs"===e.$vuetify.breakpoint.name,"text-color":"white"}},[e._v(" "+e._s(e.authorityStatusToText(t.Authority))+" ")]):e._e(),e.isadmin?n("v-chip",{class:{"common-chip":"xs"!==e.$vuetify.breakpoint.name,"common-chip-mobile":"xs"===e.$vuetify.breakpoint.name},attrs:{color:t.Authority?e.colors[0]:e.colors[1],small:"xs"===e.$vuetify.breakpoint.name,"text-color":"white"},on:{click:function(n){return e.changeAuthority(t.Id)}}},[e._v(" "+e._s(e.authorityStatusToText(t.Authority))+" ")]):e._e()],1)],1),n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{xs:"12",sm:"10",md:"10",lg:"10"}},[n("mavon-render",{model:{value:t.Content,callback:function(n){e.$set(t,"Content",n)},expression:"item.Content"}})],1)],1),n("v-card-actions",[n("v-col",{staticClass:"d-none d-sm-flex",attrs:{cols:"1"}}),n("span",{staticStyle:{"font-size":"10px",color:"grey",margin:"0 20px 0 20px"}},[e._v("发布于"+e._s(t.new_datatime))]),n("v-spacer"),!e.isadmin&&t.Author_id!=e.userId||e.closed?e._e():n("v-btn",{staticClass:"common-icon",attrs:{dark:"",small:"",elevation:"0",icon:"",color:"light-blue darken-3"},on:{click:function(n){e.editing=!0,e.edit(t.Id)}}},[n("v-icon",[e._v("mdi-comment-edit")])],1),e.isadmin?n("v-btn",{staticClass:"common-icon",attrs:{dark:"",small:"",elevation:"0",icon:"",color:"black"},on:{click:function(n){e.delete_target=t.Id,e.delete_confirmation=!0}}},[n("v-icon",[e._v("mdi-delete")])],1):e._e(),e.closed?e._e():n("v-btn",{staticClass:"common-icon",attrs:{dark:"",small:"",icon:"",elevation:"0",color:"green"},on:{click:function(n){return e.add_child_response(t.Id)}}},[n("v-icon",[e._v("mdi-chat")])],1),n("v-btn",{staticClass:"common-icon",attrs:{dark:"",color:t.Voted?"red":"grey lighten-1",small:"",icon:"",elevation:"0"},on:{click:function(n){return e.care(t.Id)}}},[n("v-icon",[e._v("mdi-heart")])],1),n("span",{staticStyle:{"font-size":"15px",margin:"5px 20px 0 0"}},[e._v(e._s(t.Vote_num))])],1),e._l(e.list,(function(r){return n("div",{key:r.Id},[r.Citing_root===t.Id&&t.Id!==r.Id?n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{xs:"12",sm:"10",md:"10",lg:"10"}},[n("v-divider"),n("v-card",{staticStyle:{border:"none"},attrs:{elevation:"0",outlined:""}},[n("v-card-title",[n("v-row",[n("div",{class:{"avatar-adapt":"xs"!==e.$vuetify.breakpoint.name}},[n("v-avatar",{staticStyle:{margin:"6px 3px 3px 3px"},attrs:{size:"xs"===e.$vuetify.breakpoint.name?20:40}},[n("v-img",{attrs:{src:r.Photo_url}})],1)],1),n("span",{class:{name:"xs"!==e.$vuetify.breakpoint.name,"name-mobile":"xs"===e.$vuetify.breakpoint.name}},[e._v(e._s(r.First_name)+" "+e._s(e.showStudentId(r.User_student_id,r.Last_name))+" ("+e._s(r.Last_name)+") 回复: "+e._s(r.Citing_first_name)+" "+e._s(e.showStudentId(e.getCitingStudentId(r.Citing_id),r.Citing_last_name))+" ("+e._s(r.Citing_last_name)+")")]),n("v-spacer"),!e.isadmin&&r.Authority?n("v-chip",{class:{"common-chip":"xs"!==e.$vuetify.breakpoint.name,"common-chip-mobile":"xs"===e.$vuetify.breakpoint.name},attrs:{color:"green",small:"xs"===e.$vuetify.breakpoint.name,"text-color":"white"}},[e._v(" "+e._s(e.authorityStatusToText(r.Authority))+" ")]):e._e(),e.isadmin?n("v-chip",{class:{"common-chip":"xs"!==e.$vuetify.breakpoint.name,"common-chip-mobile":"xs"===e.$vuetify.breakpoint.name},attrs:{color:r.Authority?e.colors[0]:e.colors[1],small:"xs"===e.$vuetify.breakpoint.name,"text-color":"white"},on:{click:function(t){return e.changeAuthority(r.Id)}}},[e._v(" "+e._s(e.authorityStatusToText(r.Authority))+" ")]):e._e()],1)],1),n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{xs:"12",sm:"10",md:"10",lg:"10"}},[n("mavon-render",{model:{value:r.Content,callback:function(t){e.$set(r,"Content",t)},expression:"n.Content"}})],1)],1),n("v-card-actions",[n("v-col",{staticClass:"d-none d-sm-flex",attrs:{cols:"1"}}),n("span",{staticStyle:{"font-size":"10px",color:"grey","margin-right":"20px","margin-left":"20px"}},[e._v("发布于"+e._s(r.new_datatime))]),n("v-spacer"),!e.isadmin&&r.Author_id!=e.userId||e.closed?e._e():n("v-btn",{staticClass:"common-icon",attrs:{dark:"",small:"",elevation:"0",icon:"",color:"light-blue darken-3"},on:{click:function(t){e.editing=!0,e.edit(r.Id)}}},[n("v-icon",[e._v("mdi-comment-edit")])],1),e.isadmin?n("v-btn",{staticClass:"common-icon",attrs:{dark:"",small:"",elevation:"0",icon:"",color:"black"},on:{click:function(t){e.delete_target=r.Id,e.delete_confirmation=!0}}},[n("v-icon",[e._v("mdi-delete")])],1):e._e(),e.closed?e._e():n("v-btn",{staticClass:"common-icon",attrs:{dark:"",small:"",icon:"",elevation:"0",color:"green"},on:{click:function(t){return e.add_child_response(r.Id)}}},[n("v-icon",[e._v("mdi-chat")])],1),n("v-btn",{staticClass:"common-icon",attrs:{dark:"",color:r.Voted?"red":"grey lighten-1",small:"",icon:"",elevation:"0"},on:{click:function(t){return e.care(r.Id)}}},[n("v-icon",[e._v("mdi-heart")])],1),n("span",{staticStyle:{"font-size":"15px",margin:"5px 20px 0 0"}},[e._v(e._s(r.Vote_num))])],1)],1)],1)],1):e._e()],1)}))],2)],1):e._e()],1)})),1)],1)],1),e.closed?e._e():n("v-dialog",{staticStyle:{"z-index":"1501"},attrs:{persistent:"","max-width":"1000px"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,a=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"mx-2",staticStyle:{"z-index":"1500 !important"},attrs:{color:"indigo",id:"btn",large:"",fab:"",dark:""}},"v-btn",a,!1),r),[n("v-icon",[e._v("mdi-plus")])],1)]}}],null,!1,491130271),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-subtitle",{staticClass:"headline"},[n("v-container",[e._v(" "+e._s(e.reply)+" ")])],1),n("v-card-text",[n("v-container",[n("mavon-editor",{ref:"comment_md",staticStyle:{width:"100%","z-index":"1 !important"},attrs:{ishljs:!0},on:{imgAdd:e.$imgAdd},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1),n("v-card-actions",[n("v-btn",{attrs:{color:"indigo lighten-1",text:""},on:{click:e.close_dialog}},[e._v(" 关闭 ")]),n("v-spacer"),n("v-btn",{attrs:{disabled:0==e.value.length,color:"indigo lighten-1",text:""},on:{click:function(t){e.editing?e.edit_response():e.add_response()}}},[e._v(" 提交 ")])],1)],1)],1),n("v-dialog",{attrs:{"max-width":"288"},model:{value:e.delete_confirmation,callback:function(t){e.delete_confirmation=t},expression:"delete_confirmation"}},[n("v-card",[n("v-card-title",[e._v("确定要删除此回复吗？")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.delete_confirmation=!1}}},[e._v(" 取消 ")]),n("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(t){e.delete_confirmation=!1,e.delete_response(e.delete_target)}}},[e._v(" 确定 ")])],1)],1)],1)],1)},Qn=[],Xn={data:function(){return{isadmin:!1,direction:"left",dialog:!1,text:"",help_list:[],list:[],reply:"请输入回复内容",value:"",dis_id:1,colors:["green","grey"],id:-1,closed:!1,root_list:[],delete_confirmation:!1,delete_target:-1,editing:!1,tags_added:[],tags_unplaced:[],editing_tags:!1,Author_id:"",userId:""}},metaInfo:function(){var e=this.text;return null!=e?{title:e+" - 讨论区 - "}:{}},methods:{getThisDiscussionTags:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,tn({DiscussionId:e.dis_id});case 2:n=t.sent,r=n.data.tagDataArray,e.tags_added=r.filter((function(e){return!0===e.owned})),e.tags_unplaced=r.filter((function(e){return!1===e.owned}));case 6:case"end":return t.stop()}}),t)})))()},add_tag:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,rn({tag:e,discussionId:t.dis_id});case 2:t.getThisDiscussionTags();case 3:case"end":return n.stop()}}),n)})))()},delete_tag:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,sn({tag:e,discussionId:t.dis_id});case 2:t.getThisDiscussionTags();case 3:case"end":return n.stop()}}),n)})))()},edit:function(e){this.id=e;var t=this.id2index(e);-1!=t&&(this.dialog=!0,this.reply="编辑",this.value=this.list[t].Content)},edit_response:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,-1===n.id){t.next=14;break}return t.next=4,Bn({responseId:Number(n.id),newContent:n.value});case 4:return t.sent,n.id=-1,n.value="",n.reply="",n.dialog=!1,n.editing=!1,t.next=12,n.get_response();case 12:t.next=15;break;case 14:console.log("undefined id");case 15:case"end":return t.stop()}}),t)})))()},care:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,En({responseId:e});case 2:return n.sent,n.next=5,t.get_response();case 5:case"end":return n.stop()}}),n)})))()},changeAuthority:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Dn({responseId:e});case 2:return n.sent,n.next=5,t.get_response();case 5:case"end":return n.stop()}}),n)})))()},close_dialog:function(){this.dialog=!1,this.editing=!1,this.value="",this.reply="请输入回复内容"},get_response:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r,a,i,s,o,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e,r=[],t.next=4,Vn({discussionId:Number(n.dis_id)});case 4:for(a=t.sent,null==a.data?n.help_list=[]:n.help_list=a.data,i=0;i<n.help_list.length;i++)n.help_list[i].id=i,n.help_list[i].btn=!1,s=n.help_list[i].Created_at.indexOf("T"),o=n.help_list[i].Created_at.indexOf("."),c=n.help_list[i].Created_at.substr(0,s),u=n.help_list[i].Created_at.substr(s+1,o-s-1),n.help_list[i].new_datatime=c+" "+u,n.help_list[i].Id===n.help_list[i].Citing_root&&r.push(n.help_list[i]);n.root_list=r,n.list=n.help_list,n.$forceUpdate();case 10:case"end":return t.stop()}}),t)})))()},add_response:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,-1===n.id){t.next=7;break}return t.next=4,Rn({citeId:e.id,content:n.value,discussionId:Number(n.$route.params.dis_id)});case 4:t.sent,t.next=10;break;case 7:return t.next=9,Rn({content:n.value,discussionId:Number(n.$route.params.dis_id)});case 9:t.sent;case 10:return n.dialog=!1,n.id=-1,t.next=14,n.get_response();case 14:n.value="";case 15:case"end":return t.stop()}}),t)})))()},add_child_response:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t,r.dialog=!0,r.reply="回复",t.id=e;case 4:case"end":return n.stop()}}),n)})))()},delete_response:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Pn({responseId:e});case 2:return n.sent,n.next=5,t.get_response();case 5:case"end":return n.stop()}}),n)})))()},get_discussion_info_byId:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,$n({discussionId:e.$route.params.dis_id});case 2:return n=t.sent,e.closed=n.data.Closed,e.text=n.data.Title,e.dis_id=n.data.Id,t.next=8,e.get_response();case 8:case"end":return t.stop()}}),t)})))()},$imgAdd:function(e,t){var n=this;return Object(S["a"])(regeneratorRuntime.mark((function r(){var a,i,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=new FormData,a.append("file",t),r.next=4,kn(a);case 4:i=r.sent,s=i.data.url,n.$refs.comment_md.$img2Url(e,s);case 7:case"end":return r.stop()}}),r)})))()},authorityStatusToText:function(e){return e?"助教认证":"未认证"},id2index:function(e){for(var t=0;t<this.list.length;t++)if(e==this.list[t].Id)return t;return-1},getCitingStudentId:function(e){var t=e.Int32,n=e.Valid;if(!n)return null;var r=this.list.filter((function(e){return e.Id===t}));return r.length>0?r[0].User_student_id:null},showStudentId:function(e,t){return"助教"===t?"":e}},computed:{},mounted:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.userId=le(),e.Author_id=e.$route.params.Author_id,t.next=4,e.get_discussion_info_byId();case 4:2===ce()&&(e.isadmin=!0),e.getThisDiscussionTags();case 6:case"end":return t.stop()}}),t)})))()}},Zn=Xn,er=(n("9c8b"),n("adda")),tr=Object(l["a"])(Zn,Kn,Qn,!1,null,null,null),nr=tr.exports;m()(tr,{VAvatar:qt["a"],VBtn:p["a"],VCard:_e["a"],VCardActions:xe["a"],VCardSubtitle:xe["b"],VCardText:xe["c"],VCardTitle:xe["d"],VChip:qn["a"],VChipGroup:Un["a"],VCol:Ut["a"],VContainer:ke["a"],VDialog:Ie["a"],VDivider:Ze["a"],VIcon:f["a"],VImg:er["a"],VList:et["a"],VListItem:tt["a"],VListItemContent:rt["a"],VRow:Yt["a"],VSpacer:Pe["a"]});var rr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isAdmin?n("v-expansion-panels",e._l(e.examsList,(function(t,r){return n("v-expansion-panel",{key:r},[n("v-expansion-panel-header",[n("v-col",{attrs:{align:"left"}},[e._v(e._s(e.formattedStartDay(t.projects[0])))]),n("v-col",{attrs:{align:"right"}},e._l(t.included_status,(function(r,a){return n("v-btn",{key:a,attrs:{color:e.GLOBAL.TimeStatusType[r].color,small:"",fab:"",dark:""},on:{click:function(n){return n.stopPropagation(),e.toggleFilter(t.status_filter,r)}}},[0===t.status_filter[r]?n("v-icon",[e._v("mdi-close")]):e._e()],1)})),1)],1),n("v-expansion-panel-content",[n("v-row",[n("v-col",{directives:[{name:"show",rawName:"v-show",value:!t.status_filter.includes(1),expression:"!current_exam.status_filter.includes(1)"}],attrs:{align:"center"}},[n("v-icon",{attrs:{"x-large":""}},[e._v("mdi-border-none-variant")]),n("div",[e._v("没有可显示的内容，检查一下筛选设置？")])],1),e._l(t.projects,(function(r,a){return n("project-info-card",{directives:[{name:"show",rawName:"v-show",value:1===t.status_filter[r.TimeStatus],expression:"current_exam.status_filter[project.TimeStatus] === 1"}],key:a,attrs:{project:r,isAdmin:e.isAdmin}})}))],2)],1)],1)})),1):e._e(),e.isAdmin?e._e():n("v-row",{attrs:{align:"stretch"}},e._l(e.projectsList,(function(t,r){return n("project-info-card",{key:r,attrs:{project:t,isAdmin:e.isAdmin}})})),1)],1)},ar=[],ir={getPielist:"/exam/pieList",getPieProblem:"/exam/pieProblems",submitExam:"/exam/submit",checkPassed:"/exam/piePass",getQueueInfo:"/exam/queue-info"};function sr(e){return or.apply(this,arguments)}function or(){return or=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:ir.getPielist,params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),or.apply(this,arguments)}function cr(e){return ur.apply(this,arguments)}function ur(){return ur=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:ir.getPieProblem,params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),ur.apply(this,arguments)}function lr(e){return dr.apply(this,arguments)}function dr(){return dr=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:ir.submitExam,body:t,method:"post"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),dr.apply(this,arguments)}function mr(e){return pr.apply(this,arguments)}function pr(){return pr=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:ir.checkPassed,params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),pr.apply(this,arguments)}function fr(e){return vr.apply(this,arguments)}function vr(){return vr=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:ir.getQueueInfo,params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),vr.apply(this,arguments)}var hr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-col",{attrs:{cols:"12",sm:"6",md:"4",lg:"3",xl:"3"}},[n("v-card",{staticClass:"project-card"},[n("v-card-title",{staticClass:"project-title"},[n("v-row",[n("v-col",[e._v(" "+e._s(e.project.Name)+" "),n("v-chip",{attrs:{color:e.GLOBAL.TimeStatusType[e.project.TimeStatus].color,"text-color":"white",small:"",label:""}},[e._v(" "+e._s(e.GLOBAL.TimeStatusType[e.project.TimeStatus].text)+" ")]),e.isAdmin?e._e():n("v-chip",{attrs:{color:e.GLOBAL.checkInStatusType[e.project.CheckInStatus].color,"text-color":"white",small:"",label:""}},[e._v(" "+e._s(e.GLOBAL.checkInStatusType[e.project.CheckInStatus].text)+" ")])],1)],1)],1),n("v-card-text",[n("v-row",[n("v-col",{attrs:{"align-self":"center"}},[n("div",[e._v("开始时间："+e._s(e.project.StartTime))]),n("div",[e._v("考试时长："+e._s(e.project.Duration)+"min")]),n("div",[e._v("座位："+e._s(e.project.Seat))]),n("div",[e._v("是否通过： "),n("v-chip",{attrs:{color:e.project.Passed?"primary":"red darken-3",small:"",outlined:""}},[e._v(" "+e._s(e.project.Passed?"通过":"未通过")+" ")])],1)])],1)],1),n("v-card-actions",[n("v-btn",{attrs:{text:"",color:"indigo",disabled:!e.project.CanSeeProblems},on:{click:function(t){return e.checkExamInfo(e.project.PieId)}}},[e._v(" 查看考试 ")])],1)],1)],1)},gr=[],br={props:["project","isAdmin"],data:function(){return{}},methods:{checkExamInfo:function(e){this.$router.push({name:"exam-info",query:{PieId:e}})}}},_r=br,xr=(n("fcea"),Object(l["a"])(_r,hr,gr,!1,null,"398fa9fe",null)),wr=xr.exports;m()(xr,{VBtn:p["a"],VCard:_e["a"],VCardActions:xe["a"],VCardText:xe["c"],VCardTitle:xe["d"],VChip:qn["a"],VCol:Ut["a"],VRow:Yt["a"]});var kr={components:{ProjectInfoCard:wr},data:function(){return{projectsList:[],examsList:[],isAdmin:!1}},computed:{onClassProjects:function(){return this.projectsList.filter((function(e){return!e.IsUnderclass}))}},metaInfo:{title:"考试列表 - "},mounted:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,sr();case 2:n=t.sent,2===ce()&&(e.isAdmin=!0),e.projectsList=n.data.map((function(e){return Object(P["a"])(Object(P["a"])({},e),{},{startDay:ze()(e.StartTime).startOf("day").valueOf()})})),e.projectsList.sort((function(e,t){return e.startDay>t.startDay?-1:e.startDay<t.startDay?1:e.TimeStatus<t.TimeStatus?-1:e.TimeStatus>t.TimeStatus?1:t.Name.localeCompare(e.Name)})),e.examsList=Array(),e.onClassProjects.forEach((function(t,n,r){e.isAdmin&&(e.$set(t,"PseudoExamID",0===n?0:r[n-1].PseudoExamID+(t.startDay===r[n-1].startDay?0:1)),void 0===e.examsList[t.PseudoExamID]&&(e.$set(e.examsList,t.PseudoExamID,{}),e.$set(e.examsList[t.PseudoExamID],"projects",Array()),e.$set(e.examsList[t.PseudoExamID],"included_status",Array()),e.$set(e.examsList[t.PseudoExamID],"status_filter",Array())),e.examsList[t.PseudoExamID].projects.push(t),e.examsList[t.PseudoExamID].included_status.includes(t.TimeStatus)||(e.examsList[t.PseudoExamID].included_status.push(t.TimeStatus),e.examsList[t.PseudoExamID].status_filter[t.TimeStatus]=1)),t.StartTime=ze()(t.StartTime).format("HH:mm:ss"),t.Seat=null==t.Seat?"未分配":t.Seat}));case 8:case"end":return t.stop()}}),t)})))()},methods:{printHelper:function(e){console.log(e)},toggleFilter:function(e,t){this.$set(e,t,1-e[t])},formattedStartDay:function(e){return ze()(e.startDay).format("YYYY-MM-DD")}}},yr=kr,Ir=(n("3373"),n("cd55")),jr=n("49e2"),Cr=n("c865"),Rr=n("0393"),Sr=Object(l["a"])(yr,rr,ar,!1,null,"8f9d9c62",null),Pr=Sr.exports;m()(Sr,{VBtn:p["a"],VCol:Ut["a"],VExpansionPanel:Ir["a"],VExpansionPanelContent:jr["a"],VExpansionPanelHeader:Cr["a"],VExpansionPanels:Rr["a"],VIcon:f["a"],VRow:Yt["a"]});var Tr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[null!=e.examInfo?n("v-row",[n("v-col",{attrs:{cols:e.$vuetify.breakpoint.mobile?12:8}},[e._l(e.examNotices,(function(t,r){return[n("v-alert",{key:r,attrs:{border:"left",outlined:"",dense:"",color:"red"}},[n("div",{staticClass:"red--text title"},[e._v("通知")]),n("div",{staticClass:"caption"},[e._v(" "+e._s(t.created_at)+" ")]),n("div",{ref:"vShowContent",refInFor:!0,domProps:{innerHTML:e._s(t.content)}})])]})),n("v-card",{attrs:{elevation:"0"}},[n("v-card-text",[n("mavon-render",{attrs:{value:e.examInfo.Description||"*暂无介绍*"}})],1)],1)],2),n("v-col",{attrs:{cols:e.$vuetify.breakpoint.mobile?12:4}},[n("v-card",[n("v-card-title",[e._v(e._s(e.examInfo.Name)+" 考试信息")]),n("v-list",[n("v-list-item",[n("v-list-item-action",[n("v-icon",[e._v("mdi-calendar")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("开始时间")]),n("v-list-item-subtitle",[e._v(e._s(e.examInfo.StartTime))])],1)],1),n("v-divider",{attrs:{inset:""}}),n("v-list-item",[n("v-list-item-action",[n("v-icon",[e._v("mdi-clock-outline")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("考试时长")]),n("v-list-item-subtitle",[e._v(e._s(e.examInfo.Duration)+" 分钟")])],1)],1),n("v-divider",{attrs:{inset:""}}),n("v-list-item",[n("v-list-item-action",[n("v-icon",[e._v("mdi-clipboard-check")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("状态")]),n("v-list-item-subtitle",[e._v(e._s(e.examStatus))])],1)],1),n("v-divider",{attrs:{inset:""}}),n("v-list-item",[n("v-list-item-action",[e.passed?n("v-icon",[e._v("mdi-lock-open-check-outline")]):e._e(),e.passed?e._e():n("v-icon",[e._v("mdi-lock-outline")])],1),n("v-list-item-content",[e.passed?n("v-list-item-title",[e._v("已达到通过条件")]):e._e(),e.passed?e._e():n("v-list-item-title",[e._v("未达到通过条件")])],1),e.passed&&1==e.examInfo.CheckInStatus?n("v-list-item-icon",[n("v-btn",{attrs:{text:"",color:"primary"},on:{click:e.submitExam}},[e._v(" 交卷排队 ")])],1):e._e()],1)],1)],1)],1)],1):e._e(),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-card",{attrs:{elevation:"0"}},[n("v-card-title",[e._v("题目列表")]),n("v-list",[n("v-divider"),n("v-list-item-group",{attrs:{multiple:""}},[e._l(e.problems,(function(t){return[n("router-link",{key:"prob-link-"+t.ProblemId.toString(),staticClass:"no-style",attrs:{to:e.viewProblemLink(t)}},[n("v-list-item",{key:"prob-item-"+t.ProblemId.toString(),attrs:{color:"indigo"}},[n("v-list-item-content",[n("v-list-item-title",[e._v(" "+e._s(t.ProblemName)+" "),n("v-chip",{attrs:{color:e.problemType[t.ProblemType].color,small:"",outlined:""}},[e._v(" "+e._s(e.problemType[t.ProblemType].text)+" ")])],1)],1),n("v-list-item-action",[t.Passed?n("v-chip",{attrs:{color:"success","text-color":"white"}},[e._v(" 已通过 ")]):t.Submitted?n("v-chip",{attrs:{color:"red darken-3","text-color":"white"}},[e._v(" 未通过 ")]):n("v-chip",{attrs:{color:"blue-grey darken-3","text-color":"white"}},[e._v(" 未提交 ")])],1)],1)],1),n("v-divider",{key:"prob-div-"+t.ProblemId.toString()})]}))],2)],1)],1)],1),0!=e.downloadProblems.length?n("v-col",{attrs:{cols:"12"}},[n("v-card",{attrs:{elevation:"0"}},[n("v-card-title",[e._v("课下提交下载")]),n("v-list",[n("v-divider"),e._l(e.downloadProblems,(function(t){return[n("v-list-item",{key:"down-item-"+t.ProblemId.toString()},[n("v-list-item-content",[n("v-list-item-title",[e._v(" "+e._s(t.ProblemName)+" ")])],1),n("v-list-item-action",[null!=t.FileName?n("download-problem-file-button",{attrs:{type:"submission",problemId:t.ProblemId,projectInExamId:e.PieId,fileName:t.FileName}}):n("v-btn",{attrs:{text:"",disabled:""}},[e._v(" 未提交 ")])],1)],1),n("v-divider",{key:"down-div-"+t.ProblemId.toString()})]}))],2)],1)],1):e._e()],1)],1)},Vr=[],Or=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-btn",{attrs:{text:"",color:"primary",loading:e.loading},on:{click:e.btnDownload}},[n("v-icon",{attrs:{left:"",dark:""}},[e._v(" mdi-cloud-download ")]),e._v(" "+e._s(e.fileName)+" ")],1)},Dr=[],Ar={getProblemInfo:"/problem/info",getProblemDataFile:"/problem/file",getLastSubmissionFile:"/problem/last-submission",submitFileAns:"/answer/upload",submitChoiceandBlankAns:"/answer/choiceAndBlank",getJudgeResult:"/answer/result",getSubmitHistory:"/answer/list"};function Er(e){return Nr.apply(this,arguments)}function Nr(){return Nr=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ar.getProblemInfo,params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Nr.apply(this,arguments)}function $r(e){return Lr.apply(this,arguments)}function Lr(){return Lr=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ar.getProblemDataFile,params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Lr.apply(this,arguments)}function Br(e){return Mr.apply(this,arguments)}function Mr(){return Mr=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ar.getLastSubmissionFile,params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Mr.apply(this,arguments)}function Fr(e,t){return Jr.apply(this,arguments)}function Jr(){return Jr=Object(S["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ar.submitFileAns,body:t,method:"post",onUploadProgress:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Jr.apply(this,arguments)}function qr(e){return Ur.apply(this,arguments)}function Ur(){return Ur=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ar.submitChoiceandBlankAns,body:t,method:"post"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Ur.apply(this,arguments)}function zr(e){return Hr.apply(this,arguments)}function Hr(){return Hr=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ar.getJudgeResult,params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Hr.apply(this,arguments)}function Yr(e){return Gr.apply(this,arguments)}function Gr(){return Gr=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:Ar.getSubmitHistory,params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Gr.apply(this,arguments)}var Wr={props:{problemId:Number,projectInExamId:Number,fileName:String,type:String},data:function(){return{loading:!1}},methods:{downloadFile:function(e){var t=document.createElement("a");t.href=e,t.download="",t.click()},btnDownload:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.loading=!0,"data"!==e.type){t.next=7;break}return t.next=4,$r({id:e.problemId,pieId:e.projectInExamId});case 4:n=t.sent,t.next=11;break;case 7:if("submission"!==e.type){t.next=11;break}return t.next=10,Br({id:e.problemId,pieId:e.projectInExamId});case 10:n=t.sent;case 11:e.loading=!1,e.downloadFile(n.data.url);case 13:case"end":return t.stop()}}),t)})))()}}},Kr=Wr,Qr=Object(l["a"])(Kr,Or,Dr,!1,null,null,null),Xr=Qr.exports;m()(Qr,{VBtn:p["a"],VIcon:f["a"]});var Zr=Ye()(),ea={components:{DownloadProblemFileButton:Xr},data:function(){return{PieId:-1,examInfo:null,problems:[],downloadProblems:[],submitLoading:!1,passed:!1,unPassedProblemsNum:0,passedProblemsNum:0,queueInfo:null,queueCount:null,isPoped:!1}},mounted:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.PieId=parseInt(e.$route.query.PieId),t.next=3,e.loadPieInfo();case 3:if(3!==e.examInfo.CheckInStatus){t.next=7;break}return t.next=6,e.refresh();case 6:0==e.isPoped&&e.initWS();case 7:return t.next=9,cr({id:e.PieId});case 9:return n=t.sent,200==n.status&&(e.problems=n.data.problems,e.downloadProblems=n.data.downloadProblems,e.problems.forEach((function(t){e.unPassedProblemsNum=e.unPassedProblemsNum+(t.Passed?0:1),e.passedProblemsNum=e.passedProblemsNum+(t.Passed?1:0)}))),t.next=13,Le({pie:e.PieId});case 13:return r=t.sent,a=(r.data.news||[]).map((function(e){return Object(P["a"])(Object(P["a"])({},e),{},{created_at:ze()(e.created_at).format("YYYY-MM-DD HH:mm:ss"),content:Zr.render(e.content)})})),e.$store.commit("notice/setNoticelist",{pie:e.PieId,notices:a}),t.next=18,e.checkPass();case 18:case"end":return t.stop()}}),t)})))()},metaInfo:function(){var e=this.examInfo;return null!=e?{title:e.Name+" 考试 - "}:{}},beforeDestroy:function(){null!=this.socket&&(console.log("socket已关闭"),this.socket.close())},computed:{examStatus:function(){return this.examInfo.IsActive?0===this.examInfo.TimeStatus&&0===this.examInfo.CheckInStatus?"未签到，考试尚未开始":0===this.examInfo.TimeStatus&&1===this.examInfo.CheckInStatus?"已签到，考试尚未开始":1===this.examInfo.TimeStatus&&0===this.examInfo.CheckInStatus?"未签到，考试已经开始":1===this.examInfo.TimeStatus&&1===this.examInfo.CheckInStatus?"考试中":2===this.examInfo.TimeStatus&&1===this.examInfo.CheckInStatus?"考试结束":2===this.examInfo.CheckInStatus?"已签退":3===this.examInfo.CheckInStatus?this.isPoped?"问答即将开始，请稍作等候":null==this.queueCount?"排队中，请耐心等待":"排队中，请耐心等待，前面还有 "+this.queueCount+" 人":"未知":"考试未激活，学生将无法访问"},examNotices:function(){return this.$store.getters["notice/getNoticesOfPie"](this.PieId).sort((function(e,t){return e.id<t.id}))}},methods:{initWS:function(){if("undefined"===typeof WebSocket)alert("您的浏览器不支持socket");else{console.log("准备打开socket");var e=this,t=B.WebSocketUrl+"/push?event=queue-"+this.queueInfo.examId+"-"+this.queueInfo.roomId;this.socket=new WebSocket(t),console.log("socket已打开!"),this.socket.onerror=function(){console.log("连接错误")},this.socket.onmessage=function(){var t=Object(S["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=JSON.parse(n.data),"pop"==r.type&&r.id<e.queueInfo.queueItemId&&e.queueCount--,"rollback"==r.type&&r.id<e.queueInfo.queueItemId&&e.queueCount--,"pop"==r.type&&r.id==e.queueInfo.queueItemId&&(e.queueCount=0,e.isPoped=!0,e.refresh());case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},refresh:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fr({pieId:e.PieId});case 2:n=t.sent,e.queueInfo=n.data,e.queueCount=e.queueInfo.position,1==e.queueInfo.popped&&(e.isPoped=!0);case 6:case"end":return t.stop()}}),t)})))()},checkPass:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,mr({id:e.PieId});case 2:n=t.sent,200==n.status&&(e.passed=n.data.passed);case 4:case"end":return t.stop()}}),t)})))()},loadPieInfo:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,sr({id:e.PieId});case 2:n=t.sent,e.examInfo=n.data[0],e.examInfo.StartTime=ze()(e.examInfo.StartTime).format("YYYY-MM-DD HH:mm:ss");case 5:case"end":return t.stop()}}),t)})))()},submitExam:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.submitLoading=!0,t.next=3,lr({pie:e.PieId});case 3:return n=t.sent,200==n.status&&e.$store.dispatch("snackbar/openSnackbar",{msg:"交卷成功",color:"green"}),e.submitLoading=!1,t.next=8,e.loadPieInfo();case 8:if(3!==e.examInfo.CheckInStatus){t.next=12;break}return t.next=11,e.refresh();case 11:e.initWS();case 12:case"end":return t.stop()}}),t)})))()},viewProblemLink:function(e){return{name:"problem-page",query:{ProblemId:e.ProblemId,PieId:this.PieId}}}}},ta=ea,na=(n("9e2a"),n("0798")),ra=n("1baa"),aa=Object(l["a"])(ta,Tr,Vr,!1,null,"3257f2d7",null),ia=aa.exports;m()(aa,{VAlert:na["a"],VBtn:p["a"],VCard:_e["a"],VCardText:xe["c"],VCardTitle:xe["d"],VChip:qn["a"],VCol:Ut["a"],VContainer:ke["a"],VDivider:Ze["a"],VIcon:f["a"],VList:et["a"],VListItem:tt["a"],VListItemAction:nt["a"],VListItemContent:rt["a"],VListItemGroup:ra["a"],VListItemIcon:at["a"],VListItemSubtitle:rt["b"],VListItemTitle:rt["c"],VRow:Yt["a"]});var sa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return null!=e.problemInfo?n("v-container",[n("div",{staticClass:"title-div"},[n("h2",{staticStyle:{display:"inline-block"}},[e._v(" "+e._s(e.problemInfo.Name)+" ")]),n("v-chip",{staticStyle:{"margin-left":"10px"},attrs:{color:e.tag.color,"text-color":"white",small:"",label:""}},[e._v(" "+e._s(e.tag.text)+" ")]),n("div",{staticClass:"spacer"}),n("span",{staticClass:"text--disabled"},[e._v(" 题目编号 "+e._s(e.problemNumberDisplay)+" ")])],1),e.problemInfo.Type==e.problemTypeId.SingleChoice||e.problemInfo.Type==e.problemTypeId.MultipleChoice||e.problemInfo.Type==e.problemTypeId.BlankFilling?n("blank-choice-problem",{attrs:{problemInfo:e.problemInfo,PieId:e.PieId},on:{"user-submit":e.userSubmit}}):e._e(),e.problemInfo.Type==e.problemTypeId.FileUpload?n("file-problem",{attrs:{problemInfo:e.problemInfo,PieId:e.PieId},on:{"user-submit":e.userSubmit}}):e._e()],1):n("div",[n("v-card-text",[e._v("加载中，请稍等...")])],1)},oa=[],ca=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",[n("v-col",[n("v-col",[n("mavon-render",{model:{value:e.problemInfo.Description,callback:function(t){e.$set(e.problemInfo,"Description",t)},expression:"problemInfo.Description"}})],1),n("v-row",{staticStyle:{"margin-top":"16px",height:"65px"}},[n("v-col",{attrs:{cols:"6"}},[e.problemInfo.JudgePermission.CanSubmit||e.isCoolingDown?n("v-btn",{attrs:{disabled:!e.hasFinished||!e.answerChanged||!e.problemInfo.JudgePermission.CanSubmit,loading:e.submitAnsLoading,"min-width":"160",color:"primary",outlined:""},on:{click:function(t){return e.submitAnswer()}}},[e.isCoolingDown?[n("v-icon",{attrs:{left:""}},[e._v(" mdi-shield-lock-outline ")]),e._v(" "+e._s(e.coolDownInformation)+" ")]:e.hasFinished?e.answerChanged?[n("v-icon",{attrs:{left:"",dark:""}},[e._v(" mdi-check-all ")]),e._v(" 提交 "+e._s(e.submitCountText)+" ")]:[e._v(" 请修改后提交 ")]:[e._v(" 请完成 ")]],2):n("span",[e._v(" "+e._s(e.problemInfo.JudgePermission.CantSubmitReason)+" ")])],1),n("v-spacer"),n("v-col",{staticClass:"center",attrs:{cols:"6"}},[e.answerChanged||null==e.lastCheckResult||e.submitAnsLoading?e._e():n("v-alert",{staticStyle:{"margin-bottom":"0px"},attrs:{dense:"",text:"",type:e.lastCheckResultText.c}},[e._v(" "+e._s(e.lastCheckResultText.t)+" ")])],1)],1),e.isChoice?n("v-list-item-group",{attrs:{multiple:e.isMultiple,mandatory:!e.isMultiple&&e.answers.length>0},model:{value:e.answers,callback:function(t){e.answers=t},expression:"answers"}},[n("v-row",e._l(e.problemInfo.Choices,(function(t){return n("v-col",{key:t.Answer,attrs:{cols:"12",sm:"12",md:"6"}},[n("v-list-item",{staticClass:"choice-border",class:e.choiceBorderStyle(t.Answer),attrs:{value:t.Answer},on:{click:e.changeAnswer},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.active;return[n("v-list-item-action",[e.isMultiple?n("v-checkbox",{attrs:{"input-value":a},on:{change:e.changeAnswer}}):e._e(),e.isMultiple?e._e():n("v-checkbox",{attrs:{"input-value":a,"on-icon":"mdi-radiobox-marked","off-icon":"mdi-radiobox-blank",readonly:!0},on:{change:e.changeAnswer}})],1),n("v-list-item-content",[n("mavon-render",{staticClass:"mavonEditor",model:{value:t.Description,callback:function(n){e.$set(t,"Description",n)},expression:"c.Description"}})],1)]}}],null,!0)})],1)})),1)],1):e._e(),e.isBlankFilling?n("div",{staticStyle:{"margin-top":"15px"}},[e._l(e.problemInfo.BlankCount,(function(t){return[n("v-text-field",{key:t,attrs:{outlined:"",clearable:"",type:"text",label:"("+t.toString()+")",error:e.blankStyle(t-1).e,success:e.blankStyle(t-1).s},on:{input:e.changeAnswer},scopedSlots:e._u([{key:"append-outer",fn:function(){return[n("v-icon",{attrs:{color:e.blankStyle(t-1).c}},[e._v(" "+e._s(e.blankStyle(t-1).i)+" ")])]},proxy:!0}],null,!0),model:{value:e.answers[t-1],callback:function(n){e.$set(e.answers,t-1,n)},expression:"answers[idx - 1]"}})]}))],2):e._e(),null!=e.problemInfo.ExtraFileName?n("download-problem-file-button",{attrs:{type:"data",problemId:e.problemId,projectInExamId:e.PieId,fileName:e.problemInfo.ExtraFileName}}):e._e()],1)],1)},ua=[],la=(n("b680"),{props:["problemInfo","PieId"],components:{DownloadProblemFileButton:Xr},data:function(){return{answers:[],submitAnsLoading:!1,judgeInfo:{},answerChanged:!1,lastCheckResult:null,correctAnswers:[],incorrectAnswers:[],submitting:!1}},computed:{isMultiple:function(){return this.problemInfo.Type==this.problemTypeId.MultipleChoice},isChoice:function(){return this.problemInfo.Type==this.problemTypeId.MultipleChoice||this.problemInfo.Type==this.problemTypeId.SingleChoice},isBlankFilling:function(){return this.problemInfo.Type==this.problemTypeId.BlankFilling},hasFinished:function(){return this.isChoice?this.answers.length>0:this.isBlankFilling?this.answers.length>=this.problemInfo.BlankCount:void 0},lastCheckResultText:function(){switch(this.lastCheckResult){case 0:return{t:"完全正确",c:"success"};case 1:return{t:"漏选",c:"warning"};case 2:return{t:"有错误",c:"error"}}return null},isCoolingDown:function(){return!this.problemInfo.JudgePermission.CanSubmit&&2==this.problemInfo.JudgePermission.CantSubmitReasonId},coolDownInformation:function(){return(this.problemInfo.JudgePermission.CoolDownTime+.5).toFixed(0)+"s"},submitCountText:function(){var e=this.problemInfo.JudgePermission.MaxSubmissionCount,t=this.problemInfo.JudgePermission.CurrentSubmissionCount;return null!=e?"(".concat(t," / ").concat(e,")"):""}},mounted:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getJudgeResult();case 2:case"end":return t.stop()}}),t)})))()},methods:{changeAnswer:function(){this.answerChanged=!0},choiceBorderStyle:function(e){if(this.correctAnswers.length+this.incorrectAnswers.length>0&&!this.answerChanged&&!this.submitAnsLoading){if(this.correctAnswers.includes(e))return"correct-sheet";if(this.incorrectAnswers.includes(e))return"incorrect-sheet"}return"normal-sheet"},blankStyle:function(e){if(this.correctAnswers.length+this.incorrectAnswers.length>0&&!this.answerChanged&&!this.submitAnsLoading){if(this.correctAnswers.includes(e))return{i:"mdi-check",c:"success",s:!0,e:!1};if(this.incorrectAnswers.includes(e))return{i:"mdi-alert-circle-outline",c:"error",s:!1,e:!0}}return{i:"",c:null,s:!1,e:!1}},submitAnswer:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.submitAnsLoading=!0,t.next=3,qr({answer:1==e.problemInfo.Type?[e.answers]:e.answers,pie:e.PieId,problemId:e.problemInfo.Id});case 3:return n=t.sent,e.problemInfo.LastSubmissionId=n.data.judgeRecordId,e.answerChanged=!1,t.next=8,e.getJudgeResult();case 8:e.submitAnsLoading=!1,e.$emit("user-submit");case 10:case"end":return t.stop()}}),t)})))()},getJudgeResult:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null==e.problemInfo.LastSubmissionId){t.next=7;break}return t.next=3,zr({id:e.problemInfo.LastSubmissionId});case 3:if(n=t.sent,r=n.data,a=null==r.comment?null:JSON.parse(r.comment),null!=a)for(e.isChoice&&!e.isMultiple?e.answers=a.studentAnswer[0]:e.answers=a.studentAnswer,e.lastCheckResult=a.check.Result,e.correctAnswers=[],e.incorrectAnswers=[],i=0;i<a.check.Detail.length;i++)e.isChoice?a.check.Detail[i]?e.correctAnswers.push(a.studentAnswer[i]):e.incorrectAnswers.push(a.studentAnswer[i]):e.isBlankFilling&&(a.check.Detail[i]?e.correctAnswers.push(i):e.incorrectAnswers.push(i));case 7:case"end":return t.stop()}}),t)})))()}}}),da=la,ma=(n("606b"),Object(l["a"])(da,ca,ua,!1,null,"32bb393f",null)),pa=ma.exports;m()(ma,{VAlert:na["a"],VBtn:p["a"],VCheckbox:we["a"],VCol:Ut["a"],VIcon:f["a"],VListItem:tt["a"],VListItemAction:nt["a"],VListItemContent:rt["a"],VListItemGroup:ra["a"],VRow:Yt["a"],VSpacer:Pe["a"],VTextField:Te["a"]});var fa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",[n("v-col",{attrs:{cols:"12",lg:"8"}},[n("mavon-render",{model:{value:e.problemInfo.Description,callback:function(t){e.$set(e.problemInfo,"Description",t)},expression:"problemInfo.Description"}}),null!=e.problemInfo.ExtraFileName?n("download-problem-file-button",{attrs:{type:"data",problemId:e.problemInfo.Id,projectInExamId:e.PieId,fileName:e.problemInfo.ExtraFileName}}):e._e()],1),n("v-col",{attrs:{cols:"12",lg:"4"}},[n("v-card",[n("v-card-title",[e._v("提交 "+e._s(e.problemInfo.Name)+" "+e._s(e.submitCountText))]),n("v-divider"),e.problemInfo.JudgePermission.CanSubmit||e.isCoolingDown||e.judgeRunning||e.uploading?n("v-card-text",{staticStyle:{display:"flex","justify-content":"space-around"}},[n("v-file-input",{staticStyle:{"padding-top":"4px"},attrs:{label:"选择文件","prepend-icon":"mdi-paperclip","show-size":"","truncate-length":"14"},scopedSlots:e._u([{key:"selection",fn:function(t){var r=t.text;return[n("v-chip",{attrs:{small:"",label:"",color:"primary"}},[e._v(" "+e._s(r)+" ")])]}}],null,!1,590729088),model:{value:e.files,callback:function(t){e.files=t},expression:"files"}}),n("v-btn",{staticClass:"ma-2 white--text",attrs:{loading:e.judgeRunning||e.uploading,disabled:(null==e.files||!e.problemInfo.JudgePermission.CanSubmit)&&!(e.judgeRunning||e.uploading),color:"indigo darken-2",text:""},on:{click:e.submitAnswer}},[e.isCoolingDown?[n("v-icon",{attrs:{left:""}},[e._v(" mdi-shield-lock-outline ")]),e._v(" "+e._s(e.coolDownInformation)+" ")]:[n("v-icon",{attrs:{left:""}},[e._v(" mdi-cloud-upload ")]),e._v(" 提交 ")]],2)],1):n("v-card-text",[e._v(e._s(e.problemInfo.JudgePermission.CantSubmitReason))]),e.hasJudgeRecord||e.uploading?n("v-divider"):e._e(),e.uploading?n("v-card-text",{staticClass:"text-subtitle-1 text-center"},[n("v-progress-linear",{model:{value:e.uploadProgressPercentage,callback:function(t){e.uploadProgressPercentage=t},expression:"uploadProgressPercentage"}}),e._v(" "+e._s(e.judgeStatusString)+" ")],1):e._e(),e.hasJudgeRecord&&e.judgeRunning?n("v-card-title",[e._v(" "+e._s(e.judgeStatusString)+" ")]):e._e(),!e.hasJudgeRecord||e.judgeRunning||e.uploading?e._e():n("div",[n("v-card-title",{staticStyle:{"justify-content":"space-between"}},[n("span",[e._v("提交记录")]),n("router-link",{attrs:{to:{name:"submit-history",query:{ProblemId:this.problemInfo.Id,PieId:this.PieId}},custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.href;return[n("v-btn",{attrs:{color:"deep-purple lighten-2",text:"",href:r,target:e.$embeddedMode?"_blank":""}},[e._v(" 查看提交历史 "),e.$embeddedMode?n("v-icon",{attrs:{right:""}},[e._v(" mdi-open-in-new ")]):e._e()],1)]}}],null,!1,3581289558)})],1),n("v-divider"),n("v-list",{staticClass:"transparent"},[n("v-list-item",[n("v-list-item-title",[e._v("ID")]),n("v-list-item-subtitle",{staticClass:"text-right"},[e._v(" "+e._s(e.judgeRecordId)+" ")])],1),n("v-list-item",[n("v-list-item-title",[e._v("提交时间")]),n("v-list-item-subtitle",{staticClass:"text-right"},[e._v(" "+e._s(this.judgeInfo.submitTime)+" ")])],1),n("v-list-item",[n("v-list-item-title",[e._v("评测结果")]),n("v-list-item-subtitle",{staticClass:"text-right"},[n("v-icon",{attrs:{color:e.judgeResultColor}},[e._v(" "+e._s(e.judgeResultIcon)+" ")]),e._v(" "+e._s(e.judgeResultInfo)+" "),n("v-btn",{attrs:{icon:""},on:{click:function(t){e.showJudgeDetail=!e.showJudgeDetail}}},[n("v-icon",[e._v(e._s(e.showJudgeDetail?"mdi-chevron-up":"mdi-chevron-down"))])],1)],1)],1)],1),n("v-expand-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:e.showJudgeDetail,expression:"showJudgeDetail"}]},[n("v-list",{staticClass:"transparent",attrs:{dense:""}},e._l(e.judgeInfo.testcases,(function(t){return n("v-list-item",{key:t.id,attrs:{"two-line":""}},[n("v-list-item-content",[n("v-list-item-title",[e._v(" 测试点 "+e._s(t.testCaseId)+" "),n("span",{class:0===t.judgeResult?"green--text":"red--text",staticStyle:{float:"right"}},[e._v(" "+e._s(t.judgeStatus)+" ")])]),n("v-list-item-subtitle",[n("pre",{staticStyle:{"white-space":"pre-wrap","word-break":"break-all"}},[e._v(e._s(t.comment))])])],1)],1)})),1)],1)])],1)],1)],1)],1)},va=[],ha=(n("d3b7"),n("25f0"),["B","KB","MB","GB","TB","PB","EB","ZB","YB"]);function ga(e){var t=0,n=parseInt(e,10)||0;while(n>=1024&&++t)n/=1024;return n.toFixed(n<10&&t>0?1:0)+" "+ha[t]}var ba=B.WebSocketUrl+"/push?event=judge",_a={components:{DownloadProblemFileButton:Xr},props:["problemInfo","PieId"],data:function(){return{files:null,submitAnsLoading:!1,timer:{},judgeRecordId:null,judgeInfo:null,pendingCount:0,showJudgeDetail:!1,uploading:!1,uploadedBytes:0,totalBytes:0}},mounted:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.socket=new WebSocket(ba),null!=e.problemInfo.LastSubmissionId&&(e.judgeRecordId=e.problemInfo.LastSubmissionId,e.init()),null!=e.judgeRecordId&&e.refresh();case 3:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.socket.close()},computed:{judgeResultMapping:function(){var e,t,n;return null!==(e=null===(t=this.judgeInfo)||void 0===t||null===(n=t.judgeResult)||void 0===n?void 0:n.toString())&&void 0!==e?e:"0"},judgeResultColor:function(){return this.GLOBAL.JudgeResult[this.judgeResultMapping].color},judgeResultIcon:function(){return this.GLOBAL.JudgeResult[this.judgeResultMapping].icon},judgeResultInfo:function(){return this.GLOBAL.JudgeResult[this.judgeResultMapping].information},hasJudgeRecord:function(){return null!=this.judgeInfo},judgeRunning:function(){return null!=this.judgeInfo&&this.judgeInfo.judgeResult<0},finished:function(){return null==this.judgeInfo||this.judgeInfo.judgeResult>=0||null==this.judgeRecordId},judgeStatusString:function(){return this.uploading?"正在上传 (".concat(ga(this.uploadedBytes)," / ").concat(ga(this.totalBytes),")"):null==this.judgeInfo?"未提交":-2==this.judgeInfo.judgeResult?"排队中，前面还有 ".concat(this.pendingCount," 人。"):-1==this.judgeInfo.judgeResult?"正在评测...":"评测结束"},uploadProgressPercentage:function(){return this.uploadedBytes/this.totalBytes*100},isCoolingDown:function(){return!this.problemInfo.JudgePermission.CanSubmit&&2==this.problemInfo.JudgePermission.CantSubmitReasonId},coolDownInformation:function(){return(this.problemInfo.JudgePermission.CoolDownTime+.5).toFixed(0)+"s"},submitCountText:function(){var e=this.problemInfo.JudgePermission.MaxSubmissionCount,t=this.problemInfo.JudgePermission.CurrentSubmissionCount;return null!=e?"(".concat(t," / ").concat(e,")"):""}},methods:{refresh:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,zr({id:e.judgeRecordId});case 2:n=t.sent,e.judgeInfo=n.data,e.judgeInfo.submitTime=ze()(e.judgeInfo.submitTime).format("YYYY-MM-DD HH:mm:ss"),e.uploading=!1,-1!=e.judgeInfo.judgeResult&&-2!=e.judgeInfo.judgeResult&&(e.judgeInfo.testcases=(e.judgeInfo.testcases||[]).map((function(t){return Object(P["a"])(Object(P["a"])({},t),{},{judgeStatus:e.GLOBAL.JudgeStatus[t.judgeResult.toString()].status})}))),e.pendingCount=n.data.pendingCount,!e.finished||0!=e.socket.readyState&&1!=e.socket.readyState||e.socket.close();case 9:case"end":return t.stop()}}),t)})))()},submitAnswer:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new FormData,null!=e.PieId&&n.append("pie",e.PieId.toString()),n.append("problem_id",e.problemInfo.Id.toString()),n.append("file",e.files),e.totalBytes=e.files.size,e.uploadedBytes=0,e.uploading=!0,t.next=9,Fr(n,(function(t){e.totalBytes=t.total,e.uploadedBytes=t.loaded}));case 9:r=t.sent,200==r.status&&(e.$store.dispatch("snackbar/openSnackbar",{msg:"文件提交成功，等待评测",color:"green"}),e.$emit("user-submit"),e.judgeRecordId=r.data.judgeRecordId,e.init()),e.refresh();case 12:case"end":return t.stop()}}),t)})))()},init:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:"undefined"===typeof WebSocket?(alert("您的浏览器不支持socket"),e.refresh()):(n=e,e.socket=new WebSocket(ba),e.socket.onerror=function(){console.log("连接错误")},e.socket.onmessage=function(){var e=Object(S["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=JSON.parse(t.data),"open"==r.type&&n.refresh(),"done"==r.type&&r.id<n.judgeRecordId&&n.pendingCount--,"started"==r.type&&r.id==n.judgeRecordId&&(n.judgeInfo.judgeResult=-1,n.pendingCount=0),"done"==r.type&&r.id==n.judgeRecordId&&(n.submitAnsLoading=!1,n.refresh());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},close:function(){this.socket.close()}}},xa=_a,wa=Object(l["a"])(xa,fa,va,!1,null,"28b501bc",null),ka=wa.exports;m()(wa,{VBtn:p["a"],VCard:_e["a"],VCardText:xe["c"],VCardTitle:xe["d"],VChip:qn["a"],VCol:Ut["a"],VDivider:Ze["a"],VExpandTransition:zn["a"],VFileInput:zt["a"],VIcon:f["a"],VList:et["a"],VListItem:tt["a"],VListItemContent:rt["a"],VListItemSubtitle:rt["b"],VListItemTitle:rt["c"],VProgressLinear:Ht["a"],VRow:Yt["a"]});var ya={components:{BlankChoiceProblem:pa,FileProblem:ka},data:function(){return{problemInfo:null,PieId:null,nextSubmissionTime:null,countdownIntervalObj:null}},metaInfo:function(){var e=this.problemInfo;return null!=e?{title:e.Name+" - "}:{}},mounted:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return null!=e.$route.query.PieId&&(e.PieId=parseInt(e.$route.query.PieId)),e.problemId=parseInt(e.$route.query.ProblemId),t.next=4,Er({id:e.problemId,pieId:e.PieId});case 4:n=t.sent,e.problemInfo=n.data,e.problemInfo.JudgePermission.CanSubmit||2!=e.problemInfo.JudgePermission.CantSubmitReasonId||e.startCountdown(),e.tag=e.problemType[e.problemInfo.Type];case 8:case"end":return t.stop()}}),t)})))()},destroyed:function(){clearInterval(this.countdownIntervalObj)},computed:{problemNumberDisplay:function(){return this.PieId?"".concat(this.PieId,"-").concat(this.problemInfo.Id):"".concat(this.problemInfo.Id)}},methods:{userSubmit:function(){if(this.problemInfo.JudgePermission.CurrentSubmissionCount++,null!=this.problemInfo.JudgePermission.MaxSubmissionCount&&this.problemInfo.JudgePermission.CurrentSubmissionCount>=this.problemInfo.JudgePermission.MaxSubmissionCount)return this.problemInfo.JudgePermission.CanSubmit=!1,this.problemInfo.JudgePermission.CantSubmitReasonId=1,void(this.problemInfo.JudgePermission.CantSubmitReason="提交次数已达上限。");null!=this.problemInfo.JudgePermission.SubmissionInterval&&(this.problemInfo.JudgePermission.CanSubmit=!1,this.problemInfo.JudgePermission.CantSubmitReasonId=2,this.problemInfo.JudgePermission.CoolDownTime=this.problemInfo.JudgePermission.SubmissionInterval,this.startCountdown())},startCountdown:function(){var e=this,t=this.problemInfo.JudgePermission.CoolDownTime,n=new Date;n.setSeconds(n.getSeconds()+t),this.nextSubmissionTime=n,clearInterval(this.countdownIntervalObj),this.countdownIntervalObj=setInterval((function(){return e.refreshCountdown()}),300)},refreshCountdown:function(){if(!this.problemInfo.JudgePermission.CanSubmit&&2==this.problemInfo.JudgePermission.CantSubmitReasonId){var e=new Date;e>this.nextSubmissionTime?(this.nextSubmissionTime=null,this.problemInfo.JudgePermission.CoolDownTime=null,this.problemInfo.JudgePermission.CanSubmit=!0):this.problemInfo.JudgePermission.CoolDownTime=(this.nextSubmissionTime-e)/1e3}}}},Ia=ya,ja=(n("aafe"),Object(l["a"])(Ia,sa,oa,!1,null,"48eb9df8",null)),Ca=ja.exports;m()(ja,{VCardText:xe["c"],VChip:qn["a"],VContainer:ke["a"]});var Ra=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{attrs:{elevation:"0"}},[n("v-card-text",[n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-card",{attrs:{elevation:"0"}},[n("v-data-table",{staticClass:"elevation-0",attrs:{headers:e.Headers,items:e.submitHistory},scopedSlots:e._u([{key:"item.passed",fn:function(t){var r=t.item;return[n("v-icon",{attrs:{color:r.passed?"green":"red"}},[e._v(" "+e._s(r.passed?"mdi-check-circle":"mdi-close-circle")+" ")])]}},{key:"item.judgeStatus",fn:function(t){var r=t.item;return[r.judgeResult<0?n("v-progress-circular",{attrs:{indeterminate:"",color:"indigo"}}):e._e(),r.judgeResult>=0?n("p",[e._v(" "+e._s(r.judgeStatus)+" ")]):e._e()]}}])})],1)],1)],1)],1)],1)},Sa=[],Pa={data:function(){return{problemId:null,PieId:null,submitHistory:[],problemName:null,Headers:[{text:"ID",align:"start",sortable:!1,value:"id"},{text:"提交时间",value:"submitTime"},{text:"通过情况",sortable:!1,value:"passed"},{text:"评测结果",sortable:!1,value:"judgeStatus"},{text:"通过样例/总样例",sortable:!1,value:"passedCases"}]}},metaInfo:function(){var e=this.problemName;return null!=e?{title:e+" 提交历史 - "}:{}},mounted:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return null!=e.$route.query.PieId?e.PieId=parseInt(e.$route.query.PieId):e.PieId=null,e.problemId=parseInt(e.$route.query.ProblemId),t.next=4,Yr({pie:e.PieId,problem_id:e.problemId});case 4:n=t.sent,200==n.status&&(e.submitHistory=n.data.record,e.problemName=n.data.problemName,e.submitHistory=(e.submitHistory||[]).map((function(t){return Object(P["a"])(Object(P["a"])({},t),{},{passed:0==t.judgeResult,judgeStatus:e.GLOBAL.JudgeStatus[t.judgeResult.toString()].status,passedCases:t.passedCaseCount.toString()+"/"+t.totalCaseCount.toString(),submitTime:ze()(t.submitTime).format("YYYY-MM-DD HH:mm:ss")})})));case 6:case"end":return t.stop()}}),t)})))()},methods:{}},Ta=Pa,Va=(n("a698"),n("8fea")),Oa=n("490a"),Da=Object(l["a"])(Ta,Ra,Sa,!1,null,"a2cbd5f6",null),Aa=Da.exports;m()(Da,{VCard:_e["a"],VCardText:xe["c"],VCol:Ut["a"],VDataTable:Va["a"],VIcon:f["a"],VProgressCircular:Oa["a"],VRow:Yt["a"]});var Ea=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[e.hasAnnouncement?n("div",e._l(e.announcements,(function(t,r){return n("v-card",{key:r,staticStyle:{"margin-bottom":"2em"},on:{dblclick:function(t){e.enlarge=!0,e.enlargeIndex=r}}},[n("v-card-title",[e._v(e._s(t.CreateTime))]),n("v-card-text",[n("mavon-render",{attrs:{value:t.Content}})],1)],1)})),1):n("mavon-render",{attrs:{value:"*暂无公告*"}}),n("v-dialog",{attrs:{fullscreen:""},model:{value:e.enlarge,callback:function(t){e.enlarge=t},expression:"enlarge"}},[n("div",{staticClass:"overlay",on:{click:function(t){e.enlarge=!1}}}),n("v-container",{staticClass:"enlarge-container",on:{click:function(t){e.enlarge=!1}}},[n("mavon-render",{attrs:{value:e.enlargeContent}})],1)],1)],1)},Na=[],$a={data:function(){return{announcements:[],enlargeIndex:0,enlarge:!1}},computed:{hasAnnouncement:function(){return this.announcements.length>0},enlargeContent:function(){var e,t;return null!==(e=null===(t=this.announcements[this.enlargeIndex])||void 0===t?void 0:t.Content)&&void 0!==e?e:"诶，有这条公告吗？"}},metaInfo:{title:"公告 - "},mounted:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ne();case 2:r=t.sent,e.announcements=(null!==(n=r.data.infoArray)&&void 0!==n?n:[]).map((function(e){return Object(P["a"])(Object(P["a"])({},e),{},{CreateTime:ze()(e.CreateTime).format("YYYY-MM-DD HH:mm:ss")})}));case 4:case"end":return t.stop()}}),t)})))()}},La=$a,Ba=(n("e00b"),Object(l["a"])(La,Ea,Na,!1,null,"6126e7c1",null)),Ma=Ba.exports;m()(Ba,{VCard:_e["a"],VCardText:xe["c"],VCardTitle:xe["d"],VContainer:ke["a"],VDialog:Ie["a"]});var Fa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[null==e.progressInfo?n("v-row",[n("v-col",{attrs:{cols:12}},[e._v(" 加载中，请稍等 ")])],1):e._e(),null!=e.progressInfo?n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("h2",[e._v(" 当前进度 "+e._s(e.progressInfo.projectName)+" "+e._s(e.progressInfo.isUnderclass?"课下":"课上")+" "),null!=e.passed?[e.passed?n("v-chip",{staticClass:"ma-2",attrs:{color:"green lighten-2",label:"","text-color":"white"}},[n("v-icon",{attrs:{left:""}},[e._v(" mdi-check ")]),e._v(" 已通过 ")],1):n("v-chip",{staticClass:"ma-2",attrs:{color:"pink lighten-2",label:"","text-color":"white"}},[n("v-icon",{attrs:{left:""}},[e._v(" mdi-run ")]),e._v(" 尚未通过 ")],1)]:e._e()],2),e.progressInfo.isUnderclass?e._e():n("span",[e._v("请在“课上考试”页面查看考试信息。")])])],1):e._e(),null!=e.progressInfo&&e.progressInfo.isUnderclass?n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-card",{attrs:{elevation:"0"}},[n("v-card-text",[n("mavon-render",{attrs:{value:e.progressInfo.pieDescription||""}})],1)],1)],1)],1):e._e(),e.problems.length>0?n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-card",{attrs:{elevation:"0"}},[n("v-card-title",[e._v("题目列表")]),n("v-list",[n("v-divider"),n("v-list-item-group",{attrs:{multiple:""}},[e._l(e.problems,(function(t){return[n("router-link",{key:"prob-link-"+t.ProblemId.toString(),staticClass:"no-style",attrs:{to:e.viewProblemLink(t)}},[n("v-list-item",{key:"prob-item-"+t.ProblemId.toString(),attrs:{color:"indigo"}},[n("v-list-item-content",[n("v-list-item-title",[e._v(" "+e._s(t.ProblemName)+" "),n("v-chip",{attrs:{color:e.problemType[t.ProblemType].color,small:"",outlined:""}},[e._v(" "+e._s(e.problemType[t.ProblemType].text)+" ")])],1)],1),n("v-list-item-action",[t.Passed?n("v-chip",{attrs:{color:"success","text-color":"white"}},[e._v(" 已通过 ")]):t.Submitted?n("v-chip",{attrs:{color:"red darken-3","text-color":"white"}},[e._v(" 未通过 ")]):n("v-chip",{attrs:{color:"blue-grey darken-3","text-color":"white"}},[e._v(" 未提交 ")])],1)],1)],1),n("v-divider",{key:"prob-div-"+t.ProblemId.toString()})]}))],2)],1)],1)],1)],1):e._e()],1)},Ja=[];function qa(e){return Ua.apply(this,arguments)}function Ua(){return Ua=Object(S["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie({url:"/underclass/progress",params:t,method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Ua.apply(this,arguments)}var za={data:function(){return{progressInfo:null,problems:[],passed:null,pieDescription:null}},metaInfo:{title:"课下提交 - "},mounted:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,qa();case 2:if(e.progressInfo=t.sent.data,e.progressInfo.isUnderclass){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,cr({id:e.progressInfo.pieId});case 7:return n=t.sent.data,e.problems=n.problems,t.next=11,e.checkPass();case 11:case"end":return t.stop()}}),t)})))()},methods:{checkPass:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,mr({id:e.progressInfo.pieId});case 2:n=t.sent,e.passed=n.data.passed;case 4:case"end":return t.stop()}}),t)})))()},viewProblemLink:function(e){return{name:"problem-page",query:{ProblemId:e.ProblemId,PieId:this.progressInfo.pieId}}}}},Ha=za,Ya=(n("dcdb"),Object(l["a"])(Ha,Fa,Ja,!1,null,"358d6c5e",null)),Ga=Ya.exports;m()(Ya,{VCard:_e["a"],VCardText:xe["c"],VCardTitle:xe["d"],VChip:qn["a"],VCol:Ut["a"],VContainer:ke["a"],VDivider:Ze["a"],VIcon:f["a"],VList:et["a"],VListItem:tt["a"],VListItemAction:nt["a"],VListItemContent:rt["a"],VListItemGroup:ra["a"],VListItemTitle:rt["c"],VRow:Yt["a"]});var Wa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{ref:"cont"},[n("v-row",[n("h2",{staticStyle:{display:"inline-block"}},[e._v("统计图")])]),n("v-row",[n("v-col",{attrs:{cols:"12",md:"4"}},[n("v-select",{staticClass:"type-sel",attrs:{items:e.types,label:"参数 1",outlined:""},model:{value:e.type1,callback:function(t){e.type1=t},expression:"type1"}})],1),n("v-col",{attrs:{cols:"12",md:"4"}},[n("v-select",{staticClass:"type-sel",attrs:{items:e.types,label:"参数 2",outlined:""},model:{value:e.type2,callback:function(t){e.type2=t},expression:"type2"}})],1),n("v-col",{attrs:{cols:"12",md:"4"}},[e.isAdmin?n("v-text-field",{staticClass:"type-sel",attrs:{label:"学号",outlined:""},model:{value:e.stuNo,callback:function(t){e.stuNo=t},expression:"stuNo"}}):e._e()],1)],1),n("v-row",[e.notFound?n("div",[e._v("暂无数据")]):e._e()]),n("v-row",[n("v-col",{attrs:{cols:"12",lg:"6"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:null!=e.url,expression:"url != null"}],staticClass:"iframe-container",style:"width: "+e.frameWidth*e.frameScale+"px; height: "+e.frameHeight*e.frameScale+"px;"},[n("iframe",{style:"transform:scale("+e.frameScale+"); width: "+e.frameWidth+"px; height: "+e.frameHeight+"px;",attrs:{src:e.url,frameborder:"0"}})])]),n("v-col",{attrs:{cols:"12",lg:"6"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:null!=e.radarUrl,expression:"radarUrl != null"}],staticClass:"iframe-container",style:"width: "+e.frameWidth*e.frameScale+"px; height: "+e.frameHeight*e.frameScale+"px;"},[n("iframe",{style:"transform:scale("+e.frameScale+"); width: "+e.frameWidth+"px; height: "+e.frameHeight+"px;",attrs:{src:e.radarUrl,frameborder:"0"}})])])],1),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("iframe",{directives:[{name:"show",rawName:"v-show",value:null!=e.recommendUrl,expression:"recommendUrl != null"}],staticStyle:{width:"100%"},attrs:{src:e.recommendUrl,frameborder:"0"}})])],1)],1)},Ka=[],Qa={data:function(){return{types:[{value:"feature_x2",text:"在线总时长"},{value:"feature_x6",text:"题目提交数量"},{value:"feature_x8",text:"题目通过数量"},{value:"feature_x17",text:"课程资源访问次数"},{value:"feature_forum",text:"讨论区活跃度"}],type1:"feature_x2",type2:"feature_x6",stuNo:"",notFound:!1,url:null,radarUrl:null,recommendUrl:null,frameScale:.5,frameHeight:10,frameWidth:10}},watch:{type1:function(){this.loadData()},type2:function(){this.loadData()},stuNo:function(){this.loadData()}},mounted:function(){var e=this;this.loadData(),this.loadFixedData(),this.$nextTick((function(){window.addEventListener("resize",e.adjustFrame)}))},beforeDestroy:function(){window.removeEventListener("resize",this.adjustFrame)},methods:{adjustFrame:function(){var e=1;switch(this.$vuetify.breakpoint.name){case"xs":e=.9;break;case"sm":e=.9;break;case"md":e=.9;break;case"lg":e=.4;break;case"xl":e=.4;break}var t=this.$refs["cont"].clientWidth,n=t*e;this.frameScale=n/1e3,this.frameWidth=(n+20)/this.frameScale,this.frameHeight=this.frameWidth/1e3*800},loadFixedData:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ve({type:"radar_chart",studentNumber:e.stuNo});case 2:return n=t.sent,n.data.found?e.radarUrl=n.data.url:e.radarUrl=null,t.next=6,ve({type:"recommendation",studentNumber:e.stuNo});case 6:r=t.sent,r.data.found?e.recommendUrl=r.data.url:e.recommendUrl=null;case 8:case"end":return t.stop()}}),t)})))()},loadData:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.selectedType,t.next=3,ve({type:n,studentNumber:e.stuNo});case 3:r=t.sent,r.data.found?(e.notFound=!1,e.url=r.data.url):(e.notFound=!0,e.url=null),e.adjustFrame();case 6:case"end":return t.stop()}}),t)})))()}},computed:{selectedType:function(){var e=["feature_x17__feature_forum","feature_x2__feature_x17","feature_x2__feature_x8","feature_x6__feature_x17","feature_x8__feature_forum","feature_x2__feature_forum","feature_x2__feature_x6","feature_x6__feature_forum","feature_x6__feature_x8","feature_x8__feature_x17"],t="".concat(this.type1,"__").concat(this.type2),n="".concat(this.type2,"__").concat(this.type1);return e.includes(t)?t:e.includes(n)?n:null},isAdmin:function(){return 2==ce()}}},Xa=Qa,Za=(n("964c"),Object(l["a"])(Xa,Wa,Ka,!1,null,"080537a2",null)),ei=Za.exports;m()(Za,{VCol:Ut["a"],VContainer:ke["a"],VRow:Yt["a"],VSelect:Se["a"],VTextField:Te["a"]}),r["a"].use(j["a"]);var ti=new j["a"]({base:"/",routes:[{path:"/",redirect:"/login"},{path:"/login",name:"login",meta:{title:"登陆"},component:Oe},{path:"/home",name:"home",meta:{title:"首页"},redirect:"/billboard",component:lt,children:[{path:"/graph",name:"graph",meta:{title:"统计图"},component:ei},{path:"/problem",name:"problem-page",meta:{title:"题目"},component:Ca},{path:"submit-history",name:"submit-history",meta:{title:"提交历史"},component:Aa},{path:"/discussion_area",name:"discussion_area",meta:{title:"讨论区"},component:Wn},{path:"/discussion_area/:dis_id/:Author_id/posts",name:"posts",meta:{title:"讨论贴"},component:nr},{path:"/account",name:"account",meta:{title:"用户中心"},component:Kt},{path:"/exams-list",name:"exams-list",meta:{title:"课上考试"},component:Pr},{path:"/exam-info",name:"exam-info",meta:{title:"课上考试"},component:ia},{path:"/underclass",name:"underclass",meta:{title:"课下进度"},component:Ga},{path:"/billboard",name:"billboard",meta:{title:"课程公告"},component:Ma}]},{path:"/retrieve/:username",name:"retrieveP",meta:{title:"重置密码"},component:Pt}]});ti.beforeEach((function(e,t,n){var r=ae.getters["user/loggedIn"];r||"login"==e.name||"retrieveP"==e.name?r&&"login"==e.name?n("/home"):n():n({path:"/login",query:{redirect:e.fullPath}})}));var ni=ti,ri=n("e72f"),ai=n.n(ri),ii=(n("8613"),{data:function(){return{problemType:[{key:0,text:"文件上传",color:"cyan"},{key:1,text:"单选",color:"orange darken-3"},{key:2,text:"多选",color:"green"},{key:3,text:"填空",color:"pink"}],problemTypeId:{FileUpload:0,SingleChoice:1,MultipleChoice:2,BlankFilling:3}}}}),si={computed:{$embeddedMode:function(){return!!this.$route.query.embedded}}},oi=n("58ca");r["a"].config.productionTip=!1,r["a"].prototype.GLOBAL=B,r["a"].use(ai.a),r["a"].use(oi["a"]),r["a"].mixin(ii),r["a"].mixin(si),new r["a"]({router:ni,vuetify:I,store:ae,render:function(e){return e(k)}}).$mount("#app")},"606b":function(e,t,n){"use strict";n("e8e4")},"62fb":function(e,t,n){},"6e94":function(e,t,n){},"74dd":function(e,t,n){},7651:function(e,t,n){},"7ea5":function(e,t,n){"use strict";n("7651")},"85ec":function(e,t,n){},9280:function(e,t,n){},"964c":function(e,t,n){"use strict";n("97c6")},"97c6":function(e,t,n){},"9c8b":function(e,t,n){"use strict";n("6e94")},"9e2a":function(e,t,n){"use strict";n("db63")},a698:function(e,t,n){"use strict";n("c502")},aafe:function(e,t,n){"use strict";n("62fb")},b4e5:function(e,t,n){},b78b:function(e,t,n){},ba95:function(e,t,n){"use strict";n("74dd")},c502:function(e,t,n){},db63:function(e,t,n){},dcdb:function(e,t,n){"use strict";n("b78b")},deba:function(e,t,n){},e00b:function(e,t,n){"use strict";n("b4e5")},e8e4:function(e,t,n){},fcea:function(e,t,n){"use strict";n("deba")}});
//# sourceMappingURL=app.6c2bab47.js.map